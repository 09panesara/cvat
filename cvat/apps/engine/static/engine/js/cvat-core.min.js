window.cvat=function(e){var t={};function n(r){if(t[r])return t[r].exports;var s=t[r]={i:r,l:!1,exports:{}};return e[r].call(s.exports,s,s.exports,n),s.l=!0,s.exports}return n.m=e,n.c=t,n.d=function(e,t,r){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var s in e)n.d(r,s,function(t){return e[t]}.bind(null,s));return r},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=22)}([function(e,t,n){(()=>{const t=n(23),r=n(25),s=n(10);class a extends Error{constructor(e){super(e);const n=(new Date).toISOString(),a=t.os.toString(),i="".concat(t.name," ").concat(t.version),o=r.parse(this)[0],c="".concat(o.fileName),u=o.lineNumber,l=o.columnNumber,{jobID:h,taskID:p,clientID:d}=s;Object.defineProperties(this,Object.freeze({system:{get:()=>a},client:{get:()=>i},time:{get:()=>n},jobID:{get:()=>h},taskID:{get:()=>p},projID:{get:()=>void 0},clientID:{get:()=>d},filename:{get:()=>c},line:{get:()=>u},column:{get:()=>l}}))}async save(){const e={system:this.system,client:this.client,time:this.time,job_id:this.jobID,task_id:this.taskID,proj_id:this.projID,client_id:this.clientID,message:this.message,filename:this.filename,line:this.line,column:this.column,stack:this.stack};try{const t=n(2);await t.server.exception(e)}catch(e){}}}e.exports={Exception:a,ArgumentError:class extends a{constructor(e){super(e)}},DataError:class extends a{constructor(e){super(e)}},ScriptingError:class extends a{constructor(e){super(e)}},PluginError:class extends a{constructor(e){super(e)}},ServerError:class extends a{constructor(e,t){super(e),Object.defineProperties(this,Object.freeze({code:{get:()=>t}}))}}}})()},function(e,t,n){"use strict";var r=n(14),s=n(41),a=Object.prototype.toString;function i(e){return"[object Array]"===a.call(e)}function o(e){return null!==e&&"object"==typeof e}function c(e){return"[object Function]"===a.call(e)}function u(e,t){if(null!=e)if("object"!=typeof e&&(e=[e]),i(e))for(var n=0,r=e.length;n<r;n++)t.call(null,e[n],n,e);else for(var s in e)Object.prototype.hasOwnProperty.call(e,s)&&t.call(null,e[s],s,e)}e.exports={isArray:i,isArrayBuffer:function(e){return"[object ArrayBuffer]"===a.call(e)},isBuffer:s,isFormData:function(e){return"undefined"!=typeof FormData&&e instanceof FormData},isArrayBufferView:function(e){return"undefined"!=typeof ArrayBuffer&&ArrayBuffer.isView?ArrayBuffer.isView(e):e&&e.buffer&&e.buffer instanceof ArrayBuffer},isString:function(e){return"string"==typeof e},isNumber:function(e){return"number"==typeof e},isObject:o,isUndefined:function(e){return void 0===e},isDate:function(e){return"[object Date]"===a.call(e)},isFile:function(e){return"[object File]"===a.call(e)},isBlob:function(e){return"[object Blob]"===a.call(e)},isFunction:c,isStream:function(e){return o(e)&&c(e.pipe)},isURLSearchParams:function(e){return"undefined"!=typeof URLSearchParams&&e instanceof URLSearchParams},isStandardBrowserEnv:function(){return("undefined"==typeof navigator||"ReactNative"!==navigator.product)&&("undefined"!=typeof window&&"undefined"!=typeof document)},forEach:u,merge:function e(){var t={};function n(n,r){"object"==typeof t[r]&&"object"==typeof n?t[r]=e(t[r],n):t[r]=n}for(var r=0,s=arguments.length;r<s;r++)u(arguments[r],n);return t},extend:function(e,t,n){return u(t,(function(t,s){e[s]=n&&"function"==typeof t?r(t,n):t})),e},trim:function(e){return e.replace(/^\s*/,"").replace(/\s*$/,"")}}},function(e,t,n){(()=>{const t=n(27),{ServerError:r}=n(0),s=n(28),a=n(10);function i(e){if(e.response){const t="".concat(e.message,". ").concat(JSON.stringify(e.response.data)||"",".");return new r(t,e.response.status)}const t="".concat(e.message,".");return new r(t,0)}const o=new class{constructor(){const o=n(39);o.defaults.withCredentials=!0,o.defaults.xsrfHeaderName="X-CSRFTOKEN",o.defaults.xsrfCookieName="csrftoken";let c=s.get("token");async function u(e=""){const{backendAPI:t}=a;let n=null;try{n=await o.get("".concat(t,"/tasks?page_size=10&").concat(e),{proxy:a.proxy})}catch(e){throw i(e)}return n.data.results.count=n.data.count,n.data.results}async function l(e){const{backendAPI:t}=a;try{await o.delete("".concat(t,"/tasks/").concat(e))}catch(e){throw i(e)}}c&&(o.defaults.headers.common.Authorization="Token ".concat(c)),Object.defineProperties(this,Object.freeze({server:{value:Object.freeze({about:async function(){const{backendAPI:e}=a;let t=null;try{t=await o.get("".concat(e,"/server/about"),{proxy:a.proxy})}catch(e){throw i(e)}return t.data},share:async function(e){const{backendAPI:t}=a;e=encodeURIComponent(e);let n=null;try{n=await o.get("".concat(t,"/server/share?directory=").concat(e),{proxy:a.proxy})}catch(e){throw i(e)}return n.data},formats:async function(){const{backendAPI:e}=a;let t=null;try{t=await o.get("".concat(e,"/server/annotation/formats"),{proxy:a.proxy})}catch(e){throw i(e)}return t.data},datasetFormats:async function(){const{backendAPI:e}=a;let t=null;try{t=await o.get("".concat(e,"/server/dataset/formats"),{proxy:a.proxy}),t=JSON.parse(t.data)}catch(e){throw i(e)}return t},exception:async function(e){const{backendAPI:t}=a;try{await o.post("".concat(t,"/server/exception"),JSON.stringify(e),{proxy:a.proxy,headers:{"Content-Type":"application/json"}})}catch(e){throw i(e)}},login:async function(e,t){const n=["".concat(encodeURIComponent("username"),"=").concat(encodeURIComponent(e)),"".concat(encodeURIComponent("password"),"=").concat(encodeURIComponent(t))].join("&").replace(/%20/g,"+");o.defaults.headers.common.Authorization="";let r=null;try{r=await o.post("".concat(a.backendAPI,"/auth/login"),n,{proxy:a.proxy})}catch(e){throw i(e)}if(r.headers["set-cookie"]){const e=r.headers["set-cookie"].join(";");o.defaults.headers.common.Cookie=e}c=r.data.key,s.set("token",c),o.defaults.headers.common.Authorization="Token ".concat(c)},logout:async function(){try{await o.post("".concat(a.backendAPI,"/auth/logout"),{proxy:a.proxy})}catch(e){throw i(e)}s.remove("token"),o.defaults.headers.common.Authorization=""},authorized:async function(){try{await e.exports.users.getSelf()}catch(e){if(401===e.code)return!1;throw e}return!0},register:async function(e,t,n,r,s,c){let u=null;try{const i=JSON.stringify({username:e,first_name:t,last_name:n,email:r,password1:s,password2:c});u=await o.post("".concat(a.backendAPI,"/auth/register"),i,{proxy:a.proxy,headers:{"Content-Type":"application/json"}})}catch(e){throw i(e)}return u.data},request:async function(e,t){try{return(await o({url:e,...t})).data}catch(e){throw i(e)}}}),writable:!1},tasks:{value:Object.freeze({getTasks:u,saveTask:async function(e,t){const{backendAPI:n}=a;try{await o.patch("".concat(n,"/tasks/").concat(e),JSON.stringify(t),{proxy:a.proxy,headers:{"Content-Type":"application/json"}})}catch(e){throw i(e)}},createTask:async function(e,n,s){const{backendAPI:c}=a,h=new t;for(const[e,t]of Object.entries(n))Array.isArray(t)?t.forEach((t,n)=>{h.append("".concat(e,"[").concat(n,"]"),t)}):h.set(e,t);let p=null;s("The task is being created on the server..");try{p=await o.post("".concat(c,"/tasks"),JSON.stringify(e),{proxy:a.proxy,headers:{"Content-Type":"application/json"}})}catch(e){throw i(e)}s("The data is being uploaded to the server..");try{await o.post("".concat(c,"/tasks/").concat(p.data.id,"/data"),h,{proxy:a.proxy})}catch(e){try{await l(p.data.id)}catch(e){}throw i(e)}try{await async function(e){return new Promise((t,n)=>{setTimeout((async function a(){try{const i=await o.get("".concat(c,"/tasks/").concat(e,"/status"));if(["Queued","Started"].includes(i.data.state))""!==i.data.message&&s(i.data.message),setTimeout(a,1e3);else if("Finished"===i.data.state)t();else if("Failed"===i.data.state){const e="Could not create the task on the server. "+"".concat(i.data.message,".");n(new r(e,400))}else n(new r("Unknown task state has been received: ".concat(i.data.state),500))}catch(e){n(i(e))}}),1e3)})}(p.data.id)}catch(e){throw await l(p.data.id),e}return(await u("?id=".concat(p.id)))[0]},deleteTask:l,exportDataset:async function(e,t){const{backendAPI:n}=a;let r="".concat(n,"/tasks/").concat(e,"/dataset?format=").concat(t);return new Promise((e,t)=>{setTimeout((async function n(){try{202===(await o.get("".concat(r),{proxy:a.proxy})).status?setTimeout(n,3e3):(r="".concat(r,"&action=download"),e(r))}catch(e){t(i(e))}}))})}}),writable:!1},jobs:{value:Object.freeze({getJob:async function(e){const{backendAPI:t}=a;let n=null;try{n=await o.get("".concat(t,"/jobs/").concat(e),{proxy:a.proxy})}catch(e){throw i(e)}return n.data},saveJob:async function(e,t){const{backendAPI:n}=a;try{await o.patch("".concat(n,"/jobs/").concat(e),JSON.stringify(t),{proxy:a.proxy,headers:{"Content-Type":"application/json"}})}catch(e){throw i(e)}}}),writable:!1},users:{value:Object.freeze({getUsers:async function(e=null){const{backendAPI:t}=a;let n=null;try{n=null===e?await o.get("".concat(t,"/users?page_size=all"),{proxy:a.proxy}):await o.get("".concat(t,"/users/").concat(e),{proxy:a.proxy})}catch(e){throw i(e)}return n.data.results},getSelf:async function(){const{backendAPI:e}=a;let t=null;try{t=await o.get("".concat(e,"/users/self"),{proxy:a.proxy})}catch(e){throw i(e)}return t.data}}),writable:!1},frames:{value:Object.freeze({getData:async function(e,t){const{backendAPI:n}=a;let r=null;try{r=await o.get("".concat(n,"/tasks/").concat(e,"/data?type=chunk&number=").concat(t,"&quality=compressed"),{proxy:a.proxy,responseType:"arraybuffer"})}catch(e){throw i(e)}return r.data},getMeta:async function(e){const{backendAPI:t}=a;let n=null;try{n=await o.get("".concat(t,"/tasks/").concat(e,"/data/meta"),{proxy:a.proxy})}catch(e){throw i(e)}return n.data},getPreview:async function(e){const{backendAPI:t}=a;let n=null;try{n=await o.get("".concat(t,"/tasks/").concat(e,"/data?type=preview"),{proxy:a.proxy,responseType:"blob"})}catch(t){const n=t.response?t.response.status:t.code;throw new r("Could not get preview frame for the task ".concat(e," from the server"),n)}return n.data}}),writable:!1},annotations:{value:Object.freeze({updateAnnotations:async function(e,t,n,r){const{backendAPI:s}=a;let c=null,u=null;"PUT"===r.toUpperCase()?(c=o.put.bind(o),u="".concat(s,"/").concat(e,"s/").concat(t,"/annotations")):(c=o.patch.bind(o),u="".concat(s,"/").concat(e,"s/").concat(t,"/annotations?action=").concat(r));let l=null;try{l=await c(u,JSON.stringify(n),{proxy:a.proxy,headers:{"Content-Type":"application/json"}})}catch(e){throw i(e)}return l.data},getAnnotations:async function(e,t){const{backendAPI:n}=a;let r=null;try{r=await o.get("".concat(n,"/").concat(e,"s/").concat(t,"/annotations"),{proxy:a.proxy})}catch(e){throw i(e)}return r.data},dumpAnnotations:async function(e,t,n){const{backendAPI:r}=a,s=t.replace(/\//g,"_");let c="".concat(r,"/tasks/").concat(e,"/annotations/").concat(s,"?format=").concat(n);return new Promise((e,t)=>{setTimeout((async function n(){o.get("".concat(c),{proxy:a.proxy}).then(t=>{202===t.status?setTimeout(n,3e3):(c="".concat(c,"&action=download"),e(c))}).catch(e=>{t(i(e))})}))})},uploadAnnotations:async function(e,n,r,s){const{backendAPI:c}=a;let u=new t;return u.append("annotation_file",r),new Promise((r,l)=>{setTimeout((async function h(){try{202===(await o.put("".concat(c,"/").concat(e,"s/").concat(n,"/annotations?format=").concat(s),u,{proxy:a.proxy})).status?(u=new t,setTimeout(h,3e3)):r()}catch(e){l(i(e))}}))})}}),writable:!1}}))}};e.exports=o})()},function(e,t,n){(function(t){var n=Object.assign?Object.assign:function(e,t,n,r){for(var s=1;s<arguments.length;s++)o(Object(arguments[s]),(function(t,n){e[n]=t}));return e},r=function(){if(Object.create)return function(e,t,r,s){var a=i(arguments,1);return n.apply(this,[Object.create(e)].concat(a))};{function e(){}return function(t,r,s,a){var o=i(arguments,1);return e.prototype=t,n.apply(this,[new e].concat(o))}}}(),s=String.prototype.trim?function(e){return String.prototype.trim.call(e)}:function(e){return e.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,"")},a="undefined"!=typeof window?window:t;function i(e,t){return Array.prototype.slice.call(e,t||0)}function o(e,t){c(e,(function(e,n){return t(e,n),!1}))}function c(e,t){if(u(e)){for(var n=0;n<e.length;n++)if(t(e[n],n))return e[n]}else for(var r in e)if(e.hasOwnProperty(r)&&t(e[r],r))return e[r]}function u(e){return null!=e&&"function"!=typeof e&&"number"==typeof e.length}e.exports={assign:n,create:r,trim:s,bind:function(e,t){return function(){return t.apply(e,Array.prototype.slice.call(arguments,0))}},slice:i,each:o,map:function(e,t){var n=u(e)?[]:{};return c(e,(function(e,r){return n[r]=t(e,r),!1})),n},pluck:c,isList:u,isFunction:function(e){return e&&"[object Function]"==={}.toString.call(e)},isObject:function(e){return e&&"[object Object]"==={}.toString.call(e)},Global:a}}).call(this,n(9))},function(e,t){(()=>{const t=Object.freeze({DIR:"DIR",REG:"REG"}),n=Object.freeze({ANNOTATION:"annotation",VALIDATION:"validation",COMPLETED:"completed"}),r=Object.freeze({ANNOTATION:"annotation",INTERPOLATION:"interpolation"}),s=Object.freeze({CHECKBOX:"checkbox",RADIO:"radio",SELECT:"select",NUMBER:"number",TEXT:"text"}),a=Object.freeze({TAG:"tag",SHAPE:"shape",TRACK:"track"}),i=Object.freeze({RECTANGLE:"rectangle",POLYGON:"polygon",POLYLINE:"polyline",POINTS:"points"});e.exports={ShareFileType:t,TaskStatus:n,TaskMode:r,AttributeType:s,ObjectType:a,ObjectShape:i,LogType:{pasteObject:0,changeAttribute:1,dragObject:2,deleteObject:3,pressShortcut:4,resizeObject:5,sendLogs:6,saveJob:7,jumpFrame:8,drawObject:9,changeLabel:10,sendTaskInfo:11,loadJob:12,moveImage:13,zoomImage:14,lockObject:15,mergeObjects:16,copyObject:17,propagateObject:18,undoAction:19,redoAction:20,sendUserActivity:21,sendException:22,changeFrame:23,debugInfo:24,fitImage:25,rotateImage:26},colors:["#FF355E","#E936A7","#FD5B78","#FF007C","#FF00CC","#66FF66","#50BFE6","#CCFF00","#FFFF66","#FF9966","#FF6037","#FFCC33","#AAF0D1","#FF3855","#FFF700","#A7F432","#FF5470","#FAFA37","#FF7A00","#FF9933","#AFE313","#00CC99","#FF5050","#733380"]}})()},function(e,t,n){(()=>{const{PluginError:t}=n(0),r=[];class s{static async apiWrapper(e,...n){const r=await s.list();for(const s of r){const r=s.functions.filter(t=>t.callback===e)[0];if(r&&r.enter)try{await r.enter.call(this,s,...n)}catch(e){throw e instanceof t?e:new t("Exception in plugin ".concat(s.name,": ").concat(e.toString()))}}let a=await e.implementation.call(this,...n);for(const s of r){const r=s.functions.filter(t=>t.callback===e)[0];if(r&&r.leave)try{a=await r.leave.call(this,s,a,...n)}catch(e){throw e instanceof t?e:new t("Exception in plugin ".concat(s.name,": ").concat(e.toString()))}}return a}static async register(e){const n=[];if("object"!=typeof e)throw new t('Plugin should be an object, but got "'.concat(typeof e,'"'));if(!("name"in e)||"string"!=typeof e.name)throw new t('Plugin must contain a "name" field and it must be a string');if(!("description"in e)||"string"!=typeof e.description)throw new t('Plugin must contain a "description" field and it must be a string');if("functions"in e)throw new t('Plugin must not contain a "functions" field');!function e(t,r){const s={};for(const n in t)Object.prototype.hasOwnProperty.call(t,n)&&("object"==typeof t[n]?Object.prototype.hasOwnProperty.call(r,n)&&e(t[n],r[n]):["enter","leave"].includes(n)&&"function"==typeof r&&(t[n],1)&&(s.callback=r,s[n]=t[n]));Object.keys(s).length&&n.push(s)}(e,{cvat:this}),Object.defineProperty(e,"functions",{value:n,writable:!1}),r.push(e)}static async list(){return r}}e.exports=s})()},function(e,t,n){(()=>{const t=n(5),r=n(2),{getFrame:s,getRanges:a,getPreview:i}=n(57),{ArgumentError:o}=n(0),{TaskStatus:c}=n(4),{Label:u}=n(7),l=n(12);function h(e){Object.defineProperties(e,{annotations:Object.freeze({value:{async upload(n,r){return await t.apiWrapper.call(this,e.annotations.upload,n,r)},async save(n){return await t.apiWrapper.call(this,e.annotations.save,n)},async clear(n=!1){return await t.apiWrapper.call(this,e.annotations.clear,n)},async dump(n,r){return await t.apiWrapper.call(this,e.annotations.dump,n,r)},async statistics(){return await t.apiWrapper.call(this,e.annotations.statistics)},async put(n=[]){return await t.apiWrapper.call(this,e.annotations.put,n)},async get(n,r={}){return await t.apiWrapper.call(this,e.annotations.get,n,r)},async search(n,r,s){return await t.apiWrapper.call(this,e.annotations.search,n,r,s)},async select(n,r,s){return await t.apiWrapper.call(this,e.annotations.select,n,r,s)},async hasUnsavedChanges(){return await t.apiWrapper.call(this,e.annotations.hasUnsavedChanges)},async merge(n){return await t.apiWrapper.call(this,e.annotations.merge,n)},async split(n,r){return await t.apiWrapper.call(this,e.annotations.split,n,r)},async group(n,r=!1){return await t.apiWrapper.call(this,e.annotations.group,n,r)},async exportDataset(n){return await t.apiWrapper.call(this,e.annotations.exportDataset,n)}},writable:!0}),frames:Object.freeze({value:{async get(n,r=!1,s=1){return await t.apiWrapper.call(this,e.frames.get,n,r,s)},async ranges(){return await t.apiWrapper.call(this,e.frames.ranges)},async preview(){return await t.apiWrapper.call(this,e.frames.preview)}},writable:!0}),logs:Object.freeze({value:{async put(n,r){return await t.apiWrapper.call(this,e.logs.put,n,r)},async save(n){return await t.apiWrapper.call(this,e.logs.save,n)}},writable:!0}),actions:Object.freeze({value:{async undo(n){return await t.apiWrapper.call(this,e.actions.undo,n)},async redo(n){return await t.apiWrapper.call(this,e.actions.redo,n)},async clear(){return await t.apiWrapper.call(this,e.actions.clear)}},writable:!0}),events:Object.freeze({value:{async subscribe(n,r){return await t.apiWrapper.call(this,e.events.subscribe,n,r)},async unsubscribe(n,r=null){return await t.apiWrapper.call(this,e.events.unsubscribe,n,r)}},writable:!0})})}class p{constructor(){}}class d extends p{constructor(e){super();const t={id:void 0,assignee:void 0,status:void 0,start_frame:void 0,stop_frame:void 0,task:void 0};for(const n in t)if(Object.prototype.hasOwnProperty.call(t,n)&&(n in e&&(t[n]=e[n]),void 0===t[n]))throw new o('Job field "'.concat(n,'" was not initialized'));Object.defineProperties(this,Object.freeze({id:{get:()=>t.id},assignee:{get:()=>t.assignee,set:e=>{if(null!==e&&!(e instanceof l))throw new o("Value must be a user instance");t.assignee=e}},status:{get:()=>t.status,set:e=>{const n=c;let r=!1;for(const t in n)if(n[t]===e){r=!0;break}if(!r)throw new o("Value must be a value from the enumeration cvat.enums.TaskStatus");t.status=e}},startFrame:{get:()=>t.start_frame},stopFrame:{get:()=>t.stop_frame},task:{get:()=>t.task}})),this.annotations={get:Object.getPrototypeOf(this).annotations.get.bind(this),put:Object.getPrototypeOf(this).annotations.put.bind(this),save:Object.getPrototypeOf(this).annotations.save.bind(this),dump:Object.getPrototypeOf(this).annotations.dump.bind(this),merge:Object.getPrototypeOf(this).annotations.merge.bind(this),split:Object.getPrototypeOf(this).annotations.split.bind(this),group:Object.getPrototypeOf(this).annotations.group.bind(this),clear:Object.getPrototypeOf(this).annotations.clear.bind(this),upload:Object.getPrototypeOf(this).annotations.upload.bind(this),select:Object.getPrototypeOf(this).annotations.select.bind(this),statistics:Object.getPrototypeOf(this).annotations.statistics.bind(this),hasUnsavedChanges:Object.getPrototypeOf(this).annotations.hasUnsavedChanges.bind(this)},this.frames={get:Object.getPrototypeOf(this).frames.get.bind(this),ranges:Object.getPrototypeOf(this).frames.ranges.bind(this),preview:Object.getPrototypeOf(this).frames.preview.bind(this)}}async save(){return await t.apiWrapper.call(this,d.prototype.save)}}class f extends p{constructor(e){super();const t={id:void 0,name:void 0,status:void 0,size:void 0,mode:void 0,owner:void 0,assignee:void 0,created_date:void 0,updated_date:void 0,bug_tracker:void 0,overlap:void 0,segment_size:void 0,z_order:void 0,image_quality:void 0,start_frame:void 0,stop_frame:void 0,frame_filter:void 0,data_chunk_size:void 0,data_compressed_chunk_type:void 0,data_original_chunk_type:void 0,use_zip_chunks:void 0};for(const n in t)Object.prototype.hasOwnProperty.call(t,n)&&n in e&&(t[n]=e[n]);if(t.labels=[],t.jobs=[],t.files=Object.freeze({server_files:[],client_files:[],remote_files:[]}),Array.isArray(e.segments))for(const n of e.segments)if(Array.isArray(n.jobs))for(const e of n.jobs){const r=new d({url:e.url,id:e.id,assignee:e.assignee,status:e.status,start_frame:n.start_frame,stop_frame:n.stop_frame,task:this});t.jobs.push(r)}if(Array.isArray(e.labels))for(const n of e.labels){const e=new u(n);t.labels.push(e)}Object.defineProperties(this,Object.freeze({id:{get:()=>t.id},name:{get:()=>t.name,set:e=>{if(!e.trim().length)throw new o("Value must not be empty");t.name=e}},status:{get:()=>t.status},size:{get:()=>t.size},mode:{get:()=>t.mode},owner:{get:()=>t.owner},assignee:{get:()=>t.assignee,set:e=>{if(null!==e&&!(e instanceof l))throw new o("Value must be a user instance");t.assignee=e}},createdDate:{get:()=>t.created_date},updatedDate:{get:()=>t.updated_date},bugTracker:{get:()=>t.bug_tracker,set:e=>{t.bug_tracker=e}},overlap:{get:()=>t.overlap,set:e=>{if(!Number.isInteger(e)||e<0)throw new o("Value must be a non negative integer");t.overlap=e}},segmentSize:{get:()=>t.segment_size,set:e=>{if(!Number.isInteger(e)||e<0)throw new o("Value must be a positive integer");t.segment_size=e}},zOrder:{get:()=>t.z_order,set:e=>{if("boolean"!=typeof e)throw new o("Value must be a boolean");t.z_order=e}},imageQuality:{get:()=>t.image_quality,set:e=>{if(!Number.isInteger(e)||e<0)throw new o("Value must be a positive integer");t.image_quality=e}},useZipChunks:{get:()=>t.use_zip_chunks,set:e=>{if("boolean"!=typeof e)throw new o("Value must be a boolean");t.use_zip_chunks=e}},labels:{get:()=>[...t.labels],set:e=>{if(!Array.isArray(e))throw new o("Value must be an array of Labels");for(const t of e)if(!(t instanceof u))throw new o("Each array value must be an instance of Label. "+"".concat(typeof t," was found"));t.labels=[...e]}},jobs:{get:()=>[...t.jobs]},serverFiles:{get:()=>[...t.files.server_files],set:e=>{if(!Array.isArray(e))throw new o("Value must be an array. But ".concat(typeof e," has been got."));for(const t of e)if("string"!=typeof t)throw new o("Array values must be a string. But ".concat(typeof t," has been got."));Array.prototype.push.apply(t.files.server_files,e)}},clientFiles:{get:()=>[...t.files.client_files],set:e=>{if(!Array.isArray(e))throw new o("Value must be an array. But ".concat(typeof e," has been got."));for(const t of e)if(!(t instanceof File))throw new o("Array values must be a File. But ".concat(t.constructor.name," has been got."));Array.prototype.push.apply(t.files.client_files,e)}},remoteFiles:{get:()=>[...t.files.remote_files],set:e=>{if(!Array.isArray(e))throw new o("Value must be an array. But ".concat(typeof e," has been got."));for(const t of e)if("string"!=typeof t)throw new o("Array values must be a string. But ".concat(typeof t," has been got."));Array.prototype.push.apply(t.files.remote_files,e)}},startFrame:{get:()=>t.start_frame,set:e=>{if(!Number.isInteger(e)||e<0)throw new o("Value must be a not negative integer");t.start_frame=e}},stopFrame:{get:()=>t.stop_frame,set:e=>{if(!Number.isInteger(e)||e<0)throw new o("Value must be a not negative integer");t.stop_frame=e}},frameFilter:{get:()=>t.frame_filter,set:e=>{if("string"!=typeof e)throw new o("Filter value must be a string. But ".concat(typeof e," has been got."));t.frame_filter=e}},dataChunkSize:{get:()=>t.data_chunk_size,set:e=>{if("number"!=typeof e||e<1)throw new o("Chunk size value must be a positive number. But value ".concat(e," has been got."));t.data_chunk_size=e}},dataChunkType:{get:()=>t.data_compressed_chunk_type}})),this.annotations={get:Object.getPrototypeOf(this).annotations.get.bind(this),put:Object.getPrototypeOf(this).annotations.put.bind(this),save:Object.getPrototypeOf(this).annotations.save.bind(this),dump:Object.getPrototypeOf(this).annotations.dump.bind(this),merge:Object.getPrototypeOf(this).annotations.merge.bind(this),split:Object.getPrototypeOf(this).annotations.split.bind(this),group:Object.getPrototypeOf(this).annotations.group.bind(this),clear:Object.getPrototypeOf(this).annotations.clear.bind(this),upload:Object.getPrototypeOf(this).annotations.upload.bind(this),select:Object.getPrototypeOf(this).annotations.select.bind(this),statistics:Object.getPrototypeOf(this).annotations.statistics.bind(this),hasUnsavedChanges:Object.getPrototypeOf(this).annotations.hasUnsavedChanges.bind(this),exportDataset:Object.getPrototypeOf(this).annotations.exportDataset.bind(this)},this.frames={get:Object.getPrototypeOf(this).frames.get.bind(this),ranges:Object.getPrototypeOf(this).frames.ranges.bind(this),preview:Object.getPrototypeOf(this).frames.preview.bind(this)}}async save(e=(()=>{})){return await t.apiWrapper.call(this,f.prototype.save,e)}async delete(){return await t.apiWrapper.call(this,f.prototype.delete)}}e.exports={Job:d,Task:f};const{getAnnotations:b,putAnnotations:m,saveAnnotations:g,hasUnsavedChanges:y,mergeAnnotations:v,splitAnnotations:w,groupAnnotations:k,clearAnnotations:O,selectObject:x,annotationsStatistics:_,uploadAnnotations:j,dumpAnnotations:S,exportDataset:T}=n(63);h(d.prototype),h(f.prototype),d.prototype.save.implementation=async function(){if(this.id){const e={status:this.status,assignee:this.assignee?this.assignee.id:null};return await r.jobs.saveJob(this.id,e),this}throw new o("Can not save job without and id")},d.prototype.frames.get.implementation=async function(e){if(!Number.isInteger(e)||e<0)throw new o('Frame must be a positive integer. Got: "'.concat(e,'"'));if(e<this.startFrame||e>this.stopFrame)throw new o("The frame with number ".concat(e," is out of the job"));return await s(this.task.id,this.task.dataChunkSize,this.task.dataChunkType,this.task.mode,e,this.startFrame,this.stopFrame)},d.prototype.frames.ranges.implementation=async function(){return await a(this.task.id)},d.prototype.annotations.get.implementation=async function(e,t){if(e<this.startFrame||e>this.stopFrame)throw new o("Frame ".concat(e," does not exist in the job"));return await b(this,e,t)},d.prototype.annotations.save.implementation=async function(e){return await g(this,e)},d.prototype.annotations.merge.implementation=async function(e){return await v(this,e)},d.prototype.annotations.split.implementation=async function(e,t){return await w(this,e,t)},d.prototype.annotations.group.implementation=async function(e,t){return await k(this,e,t)},d.prototype.annotations.hasUnsavedChanges.implementation=function(){return y(this)},d.prototype.annotations.clear.implementation=async function(e){return await O(this,e)},d.prototype.annotations.select.implementation=function(e,t,n){return x(this,e,t,n)},d.prototype.annotations.statistics.implementation=function(){return _(this)},d.prototype.annotations.put.implementation=function(e){return m(this,e)},d.prototype.annotations.upload.implementation=async function(e,t){return await j(this,e,t)},d.prototype.annotations.dump.implementation=async function(e,t){return await S(this,e,t)},f.prototype.save.implementation=async function(e){if(void 0!==this.id){const e={assignee:this.assignee?this.assignee.id:null,name:this.name,bug_tracker:this.bugTracker,z_order:this.zOrder,labels:[...this.labels.map(e=>e.toJSON())]};return await r.tasks.saveTask(this.id,e),this}const t={name:this.name,labels:this.labels.map(e=>e.toJSON()),z_order:Boolean(this.zOrder)};void 0!==this.bugTracker&&(t.bug_tracker=this.bugTracker),void 0!==this.segmentSize&&(t.segment_size=this.segmentSize),void 0!==this.overlap&&(t.overlap=this.overlap);const n={client_files:this.clientFiles,server_files:this.serverFiles,remote_files:this.remoteFiles,image_quality:this.imageQuality,use_zip_chunks:this.useZipChunks};void 0!==this.startFrame&&(n.start_frame=this.startFrame),void 0!==this.stopFrame&&(n.stop_frame=this.stopFrame),void 0!==this.frameFilter&&(n.frame_filter=this.frameFilter);const s=await r.tasks.createTask(t,n,e);return new f(s)},f.prototype.delete.implementation=async function(){return await r.tasks.deleteTask(this.id)},f.prototype.frames.get.implementation=async function(e,t,n){if(!Number.isInteger(e)||e<0)throw new o('Frame must be a positive integer. Got: "'.concat(e,'"'));if(e>=this.size)throw new o("The frame with number ".concat(e," is out of the task"));return await s(this.id,this.dataChunkSize,this.dataChunkType,this.mode,e,0,this.size-1,t,n)},d.prototype.frames.preview.implementation=async function(){return await i(this.task.id)},f.prototype.frames.ranges.implementation=async function(){return await a(this.id)},f.prototype.frames.preview.implementation=async function(){return await i(this.id)},f.prototype.annotations.get.implementation=async function(e,t){if(!Number.isInteger(e)||e<0)throw new o('Frame must be a positive integer. Got: "'.concat(e,'"'));if(e>=this.size)throw new o("Frame ".concat(e," does not exist in the task"));return await b(this,e,t)},f.prototype.annotations.save.implementation=async function(e){return await g(this,e)},f.prototype.annotations.merge.implementation=async function(e){return await v(this,e)},f.prototype.annotations.split.implementation=async function(e,t){return await w(this,e,t)},f.prototype.annotations.group.implementation=async function(e,t){return await k(this,e,t)},f.prototype.annotations.hasUnsavedChanges.implementation=function(){return y(this)},f.prototype.annotations.clear.implementation=async function(e){return await O(this,e)},f.prototype.annotations.select.implementation=function(e,t,n){return x(this,e,t,n)},f.prototype.annotations.statistics.implementation=function(){return _(this)},f.prototype.annotations.put.implementation=function(e){return m(this,e)},f.prototype.annotations.upload.implementation=async function(e,t){return await j(this,e,t)},f.prototype.annotations.dump.implementation=async function(e,t){return await S(this,e,t)},f.prototype.annotations.exportDataset.implementation=async function(e){return await T(this,e)}})()},function(e,t,n){(()=>{const{AttributeType:t,colors:r}=n(4),{ArgumentError:s}=n(0);class a{constructor(e){const n={id:void 0,default_value:void 0,input_type:void 0,mutable:void 0,name:void 0,values:void 0};for(const t in n)Object.prototype.hasOwnProperty.call(n,t)&&Object.prototype.hasOwnProperty.call(e,t)&&(Array.isArray(e[t])?n[t]=[...e[t]]:n[t]=e[t]);if(!Object.values(t).includes(n.input_type))throw new s("Got invalid attribute type ".concat(n.input_type));Object.defineProperties(this,Object.freeze({id:{get:()=>n.id},defaultValue:{get:()=>n.default_value},inputType:{get:()=>n.input_type},mutable:{get:()=>n.mutable},name:{get:()=>n.name},values:{get:()=>[...n.values]}}))}toJSON(){const e={name:this.name,mutable:this.mutable,input_type:this.inputType,default_value:this.defaultValue,values:this.values};return void 0!==this.id&&(e.id=this.id),e}}e.exports={Attribute:a,Label:class{constructor(e){const t={id:void 0,name:void 0,color:void 0};for(const n in t)Object.prototype.hasOwnProperty.call(t,n)&&Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);if(void 0!==t.id&&(t.color=r[t.id%r.length]),t.attributes=[],Object.prototype.hasOwnProperty.call(e,"attributes")&&Array.isArray(e.attributes))for(const n of e.attributes)t.attributes.push(new a(n));Object.defineProperties(this,Object.freeze({id:{get:()=>t.id},name:{get:()=>t.name},color:{get:()=>t.color,set:e=>{if(!r.includes(e))throw new s("Trying to set unknown color");t.color=e}},attributes:{get:()=>[...t.attributes]}}))}toJSON(){const e={name:this.name,attributes:[...this.attributes.map(e=>e.toJSON())]};return void 0!==this.id&&(e.id=this.id),e}}}})()},function(e,t,n){(()=>{const{ArgumentError:t}=n(0);e.exports={isBoolean:function(e){return"boolean"==typeof e},isInteger:function(e){return"number"==typeof e&&Number.isInteger(e)},isEnum:function(e){for(const t in this)if(Object.prototype.hasOwnProperty.call(this,t)&&this[t]===e)return!0;return!1},isString:function(e){return"string"==typeof e},checkFilter:function(e,n){for(const r in e)if(Object.prototype.hasOwnProperty.call(e,r)){if(!(r in n))throw new t('Unsupported filter property has been recieved: "'.concat(r,'"'));if(!n[r](e[r]))throw new t('Received filter property "'.concat(r,'" is not satisfied for checker'))}},checkObjectType:function(e,n,r,s){if(r){if(typeof n!==r){if("integer"===r&&Number.isInteger(n))return!0;throw new t('"'.concat(e,'" is expected to be "').concat(r,'", but "').concat(typeof n,'" has been got.'))}}else if(s&&!(n instanceof s)){if(void 0!==n)throw new t('"'.concat(e,'" is expected to be ').concat(s.name,", but ")+'"'.concat(n.constructor.name,'" has been got'));throw new t('"'.concat(e,'" is expected to be ').concat(s.name,', but "undefined" has been got.'))}return!0}}})()},function(e,t){var n;n=function(){return this}();try{n=n||new Function("return this")()}catch(e){"object"==typeof window&&(n=window)}e.exports=n},function(e,t){e.exports={backendAPI:"http://localhost:7000/api/v1",proxy:!1,taskID:void 0,jobID:void 0,clientID:+Date.now().toString().substr(-6)}},function(e,t,n){"use strict";(function(t){var r=n(1),s=n(43),a={"Content-Type":"application/x-www-form-urlencoded"};function i(e,t){!r.isUndefined(e)&&r.isUndefined(e["Content-Type"])&&(e["Content-Type"]=t)}var o,c={adapter:("undefined"!=typeof XMLHttpRequest?o=n(16):void 0!==t&&(o=n(16)),o),transformRequest:[function(e,t){return s(t,"Content-Type"),r.isFormData(e)||r.isArrayBuffer(e)||r.isBuffer(e)||r.isStream(e)||r.isFile(e)||r.isBlob(e)?e:r.isArrayBufferView(e)?e.buffer:r.isURLSearchParams(e)?(i(t,"application/x-www-form-urlencoded;charset=utf-8"),e.toString()):r.isObject(e)?(i(t,"application/json;charset=utf-8"),JSON.stringify(e)):e}],transformResponse:[function(e){if("string"==typeof e)try{e=JSON.parse(e)}catch(e){}return e}],timeout:0,xsrfCookieName:"XSRF-TOKEN",xsrfHeaderName:"X-XSRF-TOKEN",maxContentLength:-1,validateStatus:function(e){return e>=200&&e<300}};c.headers={common:{Accept:"application/json, text/plain, */*"}},r.forEach(["delete","get","head"],(function(e){c.headers[e]={}})),r.forEach(["post","put","patch"],(function(e){c.headers[e]=r.merge(a)})),e.exports=c}).call(this,n(15))},function(e,t){e.exports=class{constructor(e){const t={id:null,username:null,email:null,first_name:null,last_name:null,groups:null,last_login:null,date_joined:null,is_staff:null,is_superuser:null,is_active:null};for(const n in t)Object.prototype.hasOwnProperty.call(t,n)&&n in e&&(t[n]=e[n]);Object.defineProperties(this,Object.freeze({id:{get:()=>t.id},username:{get:()=>t.username},email:{get:()=>t.email},firstName:{get:()=>t.first_name},lastName:{get:()=>t.last_name},groups:{get:()=>JSON.parse(JSON.stringify(t.groups))},lastLogin:{get:()=>t.last_login},dateJoined:{get:()=>t.date_joined},isStaff:{get:()=>t.is_staff},isSuperuser:{get:()=>t.is_superuser},isActive:{get:()=>t.is_active}}))}}},function(e,t,n){(()=>{const t=n(5),{ArgumentError:r}=n(0);class s{constructor(e){const t={label:null,attributes:{},points:null,outside:null,occluded:null,keyframe:null,zOrder:null,lock:null,color:null,hidden:null,group:e.group,keyframes:e.keyframes,updated:e.updated,clientID:e.clientID,serverID:e.serverID,frame:e.frame,objectType:e.objectType,shapeType:e.shapeType,updateFlags:{}};Object.defineProperty(t.updateFlags,"reset",{value:function e(){return this.label=!1,this.attributes=!1,this.points=!1,this.outside=!1,this.occluded=!1,this.keyframe=!1,this.zOrder=!1,this.lock=!1,this.color=!1,this.hidden=!1,e},writable:!1}),Object.defineProperties(this,Object.freeze({updateFlags:{get:()=>t.updateFlags},frame:{get:()=>t.frame},objectType:{get:()=>t.objectType},shapeType:{get:()=>t.shapeType},clientID:{get:()=>t.clientID},serverID:{get:()=>t.serverID},label:{get:()=>t.label,set:e=>{t.updateFlags.label=!0,t.label=e}},color:{get:()=>t.color,set:e=>{t.updateFlags.color=!0,t.color=e}},hidden:{get:()=>t.hidden,set:e=>{t.updateFlags.hidden=!0,t.hidden=e}},points:{get:()=>t.points,set:e=>{if(!Array.isArray(e))throw new r("Points are expected to be an array "+"but got ".concat("object"==typeof e?e.constructor.name:typeof e));t.updateFlags.points=!0,t.points=[...e]}},group:{get:()=>t.group},zOrder:{get:()=>t.zOrder,set:e=>{t.updateFlags.zOrder=!0,t.zOrder=e}},outside:{get:()=>t.outside,set:e=>{t.updateFlags.outside=!0,t.outside=e}},keyframe:{get:()=>t.keyframe,set:e=>{t.updateFlags.keyframe=!0,t.keyframe=e}},keyframes:{get:()=>t.keyframes?{...t.keyframes}:null},occluded:{get:()=>t.occluded,set:e=>{t.updateFlags.occluded=!0,t.occluded=e}},lock:{get:()=>t.lock,set:e=>{t.updateFlags.lock=!0,t.lock=e}},updated:{get:()=>t.updated},attributes:{get:()=>t.attributes,set:e=>{if("object"!=typeof e)throw new r("Attributes are expected to be an object "+"but got ".concat("object"==typeof e?e.constructor.name:typeof e));for(const n of Object.keys(e))t.updateFlags.attributes=!0,t.attributes[n]=e[n]}}})),this.label=e.label,this.zOrder=e.zOrder,this.outside=e.outside,this.keyframe=e.keyframe,this.occluded=e.occluded,this.color=e.color,this.lock=e.lock,this.hidden=e.hidden,void 0!==e.points&&(this.points=e.points),void 0!==e.attributes&&(this.attributes=e.attributes),t.updateFlags.reset()}async save(){return await t.apiWrapper.call(this,s.prototype.save)}async delete(e=!1){return await t.apiWrapper.call(this,s.prototype.delete,e)}async up(){return await t.apiWrapper.call(this,s.prototype.up)}async down(){return await t.apiWrapper.call(this,s.prototype.down)}}s.prototype.save.implementation=async function(){return this.__internal&&this.__internal.save?this.__internal.save():this},s.prototype.delete.implementation=async function(e){return!(!this.__internal||!this.__internal.delete)&&this.__internal.delete(e)},s.prototype.up.implementation=async function(){return!(!this.__internal||!this.__internal.up)&&this.__internal.up()},s.prototype.down.implementation=async function(){return!(!this.__internal||!this.__internal.down)&&this.__internal.down()},e.exports=s})()},function(e,t,n){"use strict";e.exports=function(e,t){return function(){for(var n=new Array(arguments.length),r=0;r<n.length;r++)n[r]=arguments[r];return e.apply(t,n)}}},function(e,t){var n,r,s=e.exports={};function a(){throw new Error("setTimeout has not been defined")}function i(){throw new Error("clearTimeout has not been defined")}function o(e){if(n===setTimeout)return setTimeout(e,0);if((n===a||!n)&&setTimeout)return n=setTimeout,setTimeout(e,0);try{return n(e,0)}catch(t){try{return n.call(null,e,0)}catch(t){return n.call(this,e,0)}}}!function(){try{n="function"==typeof setTimeout?setTimeout:a}catch(e){n=a}try{r="function"==typeof clearTimeout?clearTimeout:i}catch(e){r=i}}();var c,u=[],l=!1,h=-1;function p(){l&&c&&(l=!1,c.length?u=c.concat(u):h=-1,u.length&&d())}function d(){if(!l){var e=o(p);l=!0;for(var t=u.length;t;){for(c=u,u=[];++h<t;)c&&c[h].run();h=-1,t=u.length}c=null,l=!1,function(e){if(r===clearTimeout)return clearTimeout(e);if((r===i||!r)&&clearTimeout)return r=clearTimeout,clearTimeout(e);try{r(e)}catch(t){try{return r.call(null,e)}catch(t){return r.call(this,e)}}}(e)}}function f(e,t){this.fun=e,this.array=t}function b(){}s.nextTick=function(e){var t=new Array(arguments.length-1);if(arguments.length>1)for(var n=1;n<arguments.length;n++)t[n-1]=arguments[n];u.push(new f(e,t)),1!==u.length||l||o(d)},f.prototype.run=function(){this.fun.apply(null,this.array)},s.title="browser",s.browser=!0,s.env={},s.argv=[],s.version="",s.versions={},s.on=b,s.addListener=b,s.once=b,s.off=b,s.removeListener=b,s.removeAllListeners=b,s.emit=b,s.prependListener=b,s.prependOnceListener=b,s.listeners=function(e){return[]},s.binding=function(e){throw new Error("process.binding is not supported")},s.cwd=function(){return"/"},s.chdir=function(e){throw new Error("process.chdir is not supported")},s.umask=function(){return 0}},function(e,t,n){"use strict";var r=n(1),s=n(44),a=n(46),i=n(47),o=n(48),c=n(17);e.exports=function(e){return new Promise((function(t,u){var l=e.data,h=e.headers;r.isFormData(l)&&delete h["Content-Type"];var p=new XMLHttpRequest;if(e.auth){var d=e.auth.username||"",f=e.auth.password||"";h.Authorization="Basic "+btoa(d+":"+f)}if(p.open(e.method.toUpperCase(),a(e.url,e.params,e.paramsSerializer),!0),p.timeout=e.timeout,p.onreadystatechange=function(){if(p&&4===p.readyState&&(0!==p.status||p.responseURL&&0===p.responseURL.indexOf("file:"))){var n="getAllResponseHeaders"in p?i(p.getAllResponseHeaders()):null,r={data:e.responseType&&"text"!==e.responseType?p.response:p.responseText,status:p.status,statusText:p.statusText,headers:n,config:e,request:p};s(t,u,r),p=null}},p.onerror=function(){u(c("Network Error",e,null,p)),p=null},p.ontimeout=function(){u(c("timeout of "+e.timeout+"ms exceeded",e,"ECONNABORTED",p)),p=null},r.isStandardBrowserEnv()){var b=n(49),m=(e.withCredentials||o(e.url))&&e.xsrfCookieName?b.read(e.xsrfCookieName):void 0;m&&(h[e.xsrfHeaderName]=m)}if("setRequestHeader"in p&&r.forEach(h,(function(e,t){void 0===l&&"content-type"===t.toLowerCase()?delete h[t]:p.setRequestHeader(t,e)})),e.withCredentials&&(p.withCredentials=!0),e.responseType)try{p.responseType=e.responseType}catch(t){if("json"!==e.responseType)throw t}"function"==typeof e.onDownloadProgress&&p.addEventListener("progress",e.onDownloadProgress),"function"==typeof e.onUploadProgress&&p.upload&&p.upload.addEventListener("progress",e.onUploadProgress),e.cancelToken&&e.cancelToken.promise.then((function(e){p&&(p.abort(),u(e),p=null)})),void 0===l&&(l=null),p.send(l)}))}},function(e,t,n){"use strict";var r=n(45);e.exports=function(e,t,n,s,a){var i=new Error(e);return r(i,t,n,s,a)}},function(e,t,n){"use strict";e.exports=function(e){return!(!e||!e.__CANCEL__)}},function(e,t,n){"use strict";function r(e){this.message=e}r.prototype.toString=function(){return"Cancel"+(this.message?": "+this.message:"")},r.prototype.__CANCEL__=!0,e.exports=r},function(e,t){e.exports=class{constructor(e,t){Object.defineProperties(this,Object.freeze({label:{get:()=>JSON.parse(JSON.stringify(e))},total:{get:()=>JSON.parse(JSON.stringify(t))}}))}}},function(e,t){(()=>{class t{constructor(e){const t=e.display_name,n=e.format,r=e.handler,s=e.version;Object.defineProperties(this,{name:{get:()=>t},format:{get:()=>n},handler:{get:()=>r},version:{get:()=>s}})}}class n{constructor(e){const t=e.display_name,n=e.format,r=e.handler,s=e.version;Object.defineProperties(this,{name:{get:()=>t},format:{get:()=>n},handler:{get:()=>r},version:{get:()=>s}})}}e.exports={AnnotationFormat:class{constructor(e){const r={created_date:e.created_date,updated_date:e.updated_date,id:e.id,owner:e.owner,name:e.name,handler_file:e.handler_file};r.dumpers=e.dumpers.map(e=>new n(e)),r.loaders=e.loaders.map(e=>new t(e)),Object.defineProperties(this,{id:{get:()=>r.id},owner:{get:()=>r.owner},name:{get:()=>r.name},createdDate:{get:()=>r.created_date},updatedDate:{get:()=>r.updated_date},handlerFile:{get:()=>r.handler_file},loaders:{get:()=>[...r.loaders]},dumpers:{get:()=>[...r.dumpers]}})}},Loader:t,Dumper:n}})()},function(e,t,n){e.exports=function(){const e=n(5),t=n(12),r=n(13),s=n(20),{Job:a,Task:i}=n(6),{Attribute:o,Label:c}=n(7),{ShareFileType:u,TaskStatus:l,TaskMode:h,AttributeType:p,ObjectType:d,ObjectShape:f,LogType:b,colors:m}=n(4),{Exception:g,ArgumentError:y,DataError:v,ScriptingError:w,PluginError:k,ServerError:O}=n(0),x=n(67),_=n(10),j={server:{about:async()=>await e.apiWrapper(j.server.about),share:async(t="/")=>await e.apiWrapper(j.server.share,t),formats:async()=>await e.apiWrapper(j.server.formats),datasetFormats:async()=>await e.apiWrapper(j.server.datasetFormats),register:async(t,n,r,s,a,i)=>await e.apiWrapper(j.server.register,t,n,r,s,a,i),login:async(t,n)=>await e.apiWrapper(j.server.login,t,n),logout:async()=>await e.apiWrapper(j.server.logout),authorized:async()=>await e.apiWrapper(j.server.authorized),request:async(t,n)=>await e.apiWrapper(j.server.request,t,n)},tasks:{get:async(t={})=>await e.apiWrapper(j.tasks.get,t)},jobs:{get:async(t={})=>await e.apiWrapper(j.jobs.get,t)},users:{get:async(t={})=>await e.apiWrapper(j.users.get,t)},plugins:{list:async()=>await e.apiWrapper(j.plugins.list),register:async t=>await e.apiWrapper(j.plugins.register,t)},config:{get backendAPI(){return _.backendAPI},set backendAPI(e){_.backendAPI=e},get proxy(){return _.proxy},set proxy(e){_.proxy=e},get taskID(){return _.taskID},set taskID(e){_.taskID=e},get jobID(){return _.jobID},set jobID(e){_.jobID=e},get clientID(){return _.clientID}},client:{version:"".concat(x.version)},enums:{ShareFileType:u,TaskStatus:l,TaskMode:h,AttributeType:p,ObjectType:d,ObjectShape:f,LogType:b,colors:m},exceptions:{Exception:g,ArgumentError:y,DataError:v,ScriptingError:w,PluginError:k,ServerError:O},classes:{Task:i,User:t,Job:a,Attribute:o,Label:c,Statistics:s,ObjectState:r}};j.server=Object.freeze(j.server),j.tasks=Object.freeze(j.tasks),j.jobs=Object.freeze(j.jobs),j.users=Object.freeze(j.users),j.plugins=Object.freeze(j.plugins),j.client=Object.freeze(j.client),j.enums=Object.freeze(j.enums);const S=n(68);return Math.clamp=function(e,t,n){return Math.min(Math.max(e,t),n)},Object.freeze(S(j))}()},function(e,t,n){(function(e,r){var s;
/*!
 * Platform.js <https://mths.be/platform>
 * Copyright 2014-2018 Benjamin Tan <https://bnjmnt4n.now.sh/>
 * Copyright 2011-2013 John-David Dalton <http://allyoucanleet.com/>
 * Available under MIT license <https://mths.be/mit>
 */(function(){"use strict";var a={function:!0,object:!0},i=a[typeof window]&&window||this,o=a[typeof t]&&t,c=a[typeof e]&&e&&!e.nodeType&&e,u=o&&c&&"object"==typeof r&&r;!u||u.global!==u&&u.window!==u&&u.self!==u||(i=u);var l=Math.pow(2,53)-1,h=/\bOpera/,p=Object.prototype,d=p.hasOwnProperty,f=p.toString;function b(e){return(e=String(e)).charAt(0).toUpperCase()+e.slice(1)}function m(e){return e=k(e),/^(?:webOS|i(?:OS|P))/.test(e)?e:b(e)}function g(e,t){for(var n in e)d.call(e,n)&&t(e[n],n,e)}function y(e){return null==e?b(e):f.call(e).slice(8,-1)}function v(e){return String(e).replace(/([ -])(?!$)/g,"$1?")}function w(e,t){var n=null;return function(e,t){var n=-1,r=e?e.length:0;if("number"==typeof r&&r>-1&&r<=l)for(;++n<r;)t(e[n],n,e);else g(e,t)}(e,(function(r,s){n=t(n,r,s,e)})),n}function k(e){return String(e).replace(/^ +| +$/g,"")}var O=function e(t){var n=i,r=t&&"object"==typeof t&&"String"!=y(t);r&&(n=t,t=null);var s=n.navigator||{},a=s.userAgent||"";t||(t=a);var o,c,u,l,p,d=r?!!s.likeChrome:/\bChrome\b/.test(t)&&!/internal|\n/i.test(f.toString()),b=r?"Object":"ScriptBridgingProxyObject",O=r?"Object":"Environment",x=r&&n.java?"JavaPackage":y(n.java),_=r?"Object":"RuntimeObject",j=/\bJava/.test(x)&&n.java,S=j&&y(n.environment)==O,T=j?"a":"α",C=j?"b":"β",A=n.document||{},P=n.operamini||n.opera,F=h.test(F=r&&P?P["[[Class]]"]:y(P))?F:P=null,I=t,E=[],N=null,M=t==a,z=M&&P&&"function"==typeof P.version&&P.version(),D=w([{label:"EdgeHTML",pattern:"Edge"},"Trident",{label:"WebKit",pattern:"AppleWebKit"},"iCab","Presto","NetFront","Tasman","KHTML","Gecko"],(function(e,n){return e||RegExp("\\b"+(n.pattern||v(n))+"\\b","i").exec(t)&&(n.label||n)})),R=function(e){return w(e,(function(e,n){return e||RegExp("\\b"+(n.pattern||v(n))+"\\b","i").exec(t)&&(n.label||n)}))}(["Adobe AIR","Arora","Avant Browser","Breach","Camino","Electron","Epiphany","Fennec","Flock","Galeon","GreenBrowser","iCab","Iceweasel","K-Meleon","Konqueror","Lunascape","Maxthon",{label:"Microsoft Edge",pattern:"Edge"},"Midori","Nook Browser","PaleMoon","PhantomJS","Raven","Rekonq","RockMelt",{label:"Samsung Internet",pattern:"SamsungBrowser"},"SeaMonkey",{label:"Silk",pattern:"(?:Cloud9|Silk-Accelerated)"},"Sleipnir","SlimBrowser",{label:"SRWare Iron",pattern:"Iron"},"Sunrise","Swiftfox","Waterfox","WebPositive","Opera Mini",{label:"Opera Mini",pattern:"OPiOS"},"Opera",{label:"Opera",pattern:"OPR"},"Chrome",{label:"Chrome Mobile",pattern:"(?:CriOS|CrMo)"},{label:"Firefox",pattern:"(?:Firefox|Minefield)"},{label:"Firefox for iOS",pattern:"FxiOS"},{label:"IE",pattern:"IEMobile"},{label:"IE",pattern:"MSIE"},"Safari"]),B=L([{label:"BlackBerry",pattern:"BB10"},"BlackBerry",{label:"Galaxy S",pattern:"GT-I9000"},{label:"Galaxy S2",pattern:"GT-I9100"},{label:"Galaxy S3",pattern:"GT-I9300"},{label:"Galaxy S4",pattern:"GT-I9500"},{label:"Galaxy S5",pattern:"SM-G900"},{label:"Galaxy S6",pattern:"SM-G920"},{label:"Galaxy S6 Edge",pattern:"SM-G925"},{label:"Galaxy S7",pattern:"SM-G930"},{label:"Galaxy S7 Edge",pattern:"SM-G935"},"Google TV","Lumia","iPad","iPod","iPhone","Kindle",{label:"Kindle Fire",pattern:"(?:Cloud9|Silk-Accelerated)"},"Nexus","Nook","PlayBook","PlayStation Vita","PlayStation","TouchPad","Transformer",{label:"Wii U",pattern:"WiiU"},"Wii","Xbox One",{label:"Xbox 360",pattern:"Xbox"},"Xoom"]),q=function(e){return w(e,(function(e,n,r){return e||(n[B]||n[/^[a-z]+(?: +[a-z]+\b)*/i.exec(B)]||RegExp("\\b"+v(r)+"(?:\\b|\\w*\\d)","i").exec(t))&&r}))}({Apple:{iPad:1,iPhone:1,iPod:1},Archos:{},Amazon:{Kindle:1,"Kindle Fire":1},Asus:{Transformer:1},"Barnes & Noble":{Nook:1},BlackBerry:{PlayBook:1},Google:{"Google TV":1,Nexus:1},HP:{TouchPad:1},HTC:{},LG:{},Microsoft:{Xbox:1,"Xbox One":1},Motorola:{Xoom:1},Nintendo:{"Wii U":1,Wii:1},Nokia:{Lumia:1},Samsung:{"Galaxy S":1,"Galaxy S2":1,"Galaxy S3":1,"Galaxy S4":1},Sony:{PlayStation:1,"PlayStation Vita":1}}),U=function(e){return w(e,(function(e,n){var r=n.pattern||v(n);return!e&&(e=RegExp("\\b"+r+"(?:/[\\d.]+|[ \\w.]*)","i").exec(t))&&(e=function(e,t,n){var r={"10.0":"10",6.4:"10 Technical Preview",6.3:"8.1",6.2:"8",6.1:"Server 2008 R2 / 7","6.0":"Server 2008 / Vista",5.2:"Server 2003 / XP 64-bit",5.1:"XP",5.01:"2000 SP1","5.0":"2000","4.0":"NT","4.90":"ME"};return t&&n&&/^Win/i.test(e)&&!/^Windows Phone /i.test(e)&&(r=r[/[\d.]+$/.exec(e)])&&(e="Windows "+r),e=String(e),t&&n&&(e=e.replace(RegExp(t,"i"),n)),e=m(e.replace(/ ce$/i," CE").replace(/\bhpw/i,"web").replace(/\bMacintosh\b/,"Mac OS").replace(/_PowerPC\b/i," OS").replace(/\b(OS X) [^ \d]+/i,"$1").replace(/\bMac (OS X)\b/,"$1").replace(/\/(\d)/," $1").replace(/_/g,".").replace(/(?: BePC|[ .]*fc[ \d.]+)$/i,"").replace(/\bx86\.64\b/gi,"x86_64").replace(/\b(Windows Phone) OS\b/,"$1").replace(/\b(Chrome OS \w+) [\d.]+\b/,"$1").split(" on ")[0])}(e,r,n.label||n)),e}))}(["Windows Phone","Android","CentOS",{label:"Chrome OS",pattern:"CrOS"},"Debian","Fedora","FreeBSD","Gentoo","Haiku","Kubuntu","Linux Mint","OpenBSD","Red Hat","SuSE","Ubuntu","Xubuntu","Cygwin","Symbian OS","hpwOS","webOS ","webOS","Tablet OS","Tizen","Linux","Mac OS X","Macintosh","Mac","Windows 98;","Windows "]);function L(e){return w(e,(function(e,n){var r=n.pattern||v(n);return!e&&(e=RegExp("\\b"+r+" *\\d+[.\\w_]*","i").exec(t)||RegExp("\\b"+r+" *\\w+-[\\w]*","i").exec(t)||RegExp("\\b"+r+"(?:; *(?:[a-z]+[_-])?[a-z]+\\d+|[^ ();-]*)","i").exec(t))&&((e=String(n.label&&!RegExp(r,"i").test(n.label)?n.label:e).split("/"))[1]&&!/[\d.]+/.test(e[0])&&(e[0]+=" "+e[1]),n=n.label||n,e=m(e[0].replace(RegExp(r,"i"),n).replace(RegExp("; *(?:"+n+"[_-])?","i")," ").replace(RegExp("("+n+")[-_.]?(\\w)","i"),"$1 $2"))),e}))}if(D&&(D=[D]),q&&!B&&(B=L([q])),(o=/\bGoogle TV\b/.exec(B))&&(B=o[0]),/\bSimulator\b/i.test(t)&&(B=(B?B+" ":"")+"Simulator"),"Opera Mini"==R&&/\bOPiOS\b/.test(t)&&E.push("running in Turbo/Uncompressed mode"),"IE"==R&&/\blike iPhone OS\b/.test(t)?(q=(o=e(t.replace(/like iPhone OS/,""))).manufacturer,B=o.product):/^iP/.test(B)?(R||(R="Safari"),U="iOS"+((o=/ OS ([\d_]+)/i.exec(t))?" "+o[1].replace(/_/g,"."):"")):"Konqueror"!=R||/buntu/i.test(U)?q&&"Google"!=q&&(/Chrome/.test(R)&&!/\bMobile Safari\b/i.test(t)||/\bVita\b/.test(B))||/\bAndroid\b/.test(U)&&/^Chrome/.test(R)&&/\bVersion\//i.test(t)?(R="Android Browser",U=/\bAndroid\b/.test(U)?U:"Android"):"Silk"==R?(/\bMobi/i.test(t)||(U="Android",E.unshift("desktop mode")),/Accelerated *= *true/i.test(t)&&E.unshift("accelerated")):"PaleMoon"==R&&(o=/\bFirefox\/([\d.]+)\b/.exec(t))?E.push("identifying as Firefox "+o[1]):"Firefox"==R&&(o=/\b(Mobile|Tablet|TV)\b/i.exec(t))?(U||(U="Firefox OS"),B||(B=o[1])):!R||(o=!/\bMinefield\b/i.test(t)&&/\b(?:Firefox|Safari)\b/.exec(R))?(R&&!B&&/[\/,]|^[^(]+?\)/.test(t.slice(t.indexOf(o+"/")+8))&&(R=null),(o=B||q||U)&&(B||q||/\b(?:Android|Symbian OS|Tablet OS|webOS)\b/.test(U))&&(R=/[a-z]+(?: Hat)?/i.exec(/\bAndroid\b/.test(U)?U:o)+" Browser")):"Electron"==R&&(o=(/\bChrome\/([\d.]+)\b/.exec(t)||0)[1])&&E.push("Chromium "+o):U="Kubuntu",z||(z=w(["(?:Cloud9|CriOS|CrMo|Edge|FxiOS|IEMobile|Iron|Opera ?Mini|OPiOS|OPR|Raven|SamsungBrowser|Silk(?!/[\\d.]+$))","Version",v(R),"(?:Firefox|Minefield|NetFront)"],(function(e,n){return e||(RegExp(n+"(?:-[\\d.]+/|(?: for [\\w-]+)?[ /-])([\\d.]+[^ ();/_-]*)","i").exec(t)||0)[1]||null}))),(o=("iCab"==D&&parseFloat(z)>3?"WebKit":/\bOpera\b/.test(R)&&(/\bOPR\b/.test(t)?"Blink":"Presto"))||/\b(?:Midori|Nook|Safari)\b/i.test(t)&&!/^(?:Trident|EdgeHTML)$/.test(D)&&"WebKit"||!D&&/\bMSIE\b/i.test(t)&&("Mac OS"==U?"Tasman":"Trident")||"WebKit"==D&&/\bPlayStation\b(?! Vita\b)/i.test(R)&&"NetFront")&&(D=[o]),"IE"==R&&(o=(/; *(?:XBLWP|ZuneWP)(\d+)/i.exec(t)||0)[1])?(R+=" Mobile",U="Windows Phone "+(/\+$/.test(o)?o:o+".x"),E.unshift("desktop mode")):/\bWPDesktop\b/i.test(t)?(R="IE Mobile",U="Windows Phone 8.x",E.unshift("desktop mode"),z||(z=(/\brv:([\d.]+)/.exec(t)||0)[1])):"IE"!=R&&"Trident"==D&&(o=/\brv:([\d.]+)/.exec(t))&&(R&&E.push("identifying as "+R+(z?" "+z:"")),R="IE",z=o[1]),M){if(l="global",p=null!=(u=n)?typeof u[l]:"number",/^(?:boolean|number|string|undefined)$/.test(p)||"object"==p&&!u[l])y(o=n.runtime)==b?(R="Adobe AIR",U=o.flash.system.Capabilities.os):y(o=n.phantom)==_?(R="PhantomJS",z=(o=o.version||null)&&o.major+"."+o.minor+"."+o.patch):"number"==typeof A.documentMode&&(o=/\bTrident\/(\d+)/i.exec(t))?(z=[z,A.documentMode],(o=+o[1]+4)!=z[1]&&(E.push("IE "+z[1]+" mode"),D&&(D[1]=""),z[1]=o),z="IE"==R?String(z[1].toFixed(1)):z[0]):"number"==typeof A.documentMode&&/^(?:Chrome|Firefox)\b/.test(R)&&(E.push("masking as "+R+" "+z),R="IE",z="11.0",D=["Trident"],U="Windows");else if(j&&(I=(o=j.lang.System).getProperty("os.arch"),U=U||o.getProperty("os.name")+" "+o.getProperty("os.version")),S){try{z=n.require("ringo/engine").version.join("."),R="RingoJS"}catch(e){(o=n.system)&&o.global.system==n.system&&(R="Narwhal",U||(U=o[0].os||null))}R||(R="Rhino")}else"object"==typeof n.process&&!n.process.browser&&(o=n.process)&&("object"==typeof o.versions&&("string"==typeof o.versions.electron?(E.push("Node "+o.versions.node),R="Electron",z=o.versions.electron):"string"==typeof o.versions.nw&&(E.push("Chromium "+z,"Node "+o.versions.node),R="NW.js",z=o.versions.nw)),R||(R="Node.js",I=o.arch,U=o.platform,z=(z=/[\d.]+/.exec(o.version))?z[0]:null));U=U&&m(U)}if(z&&(o=/(?:[ab]|dp|pre|[ab]\d+pre)(?:\d+\+?)?$/i.exec(z)||/(?:alpha|beta)(?: ?\d)?/i.exec(t+";"+(M&&s.appMinorVersion))||/\bMinefield\b/i.test(t)&&"a")&&(N=/b/i.test(o)?"beta":"alpha",z=z.replace(RegExp(o+"\\+?$"),"")+("beta"==N?C:T)+(/\d+\+?/.exec(o)||"")),"Fennec"==R||"Firefox"==R&&/\b(?:Android|Firefox OS)\b/.test(U))R="Firefox Mobile";else if("Maxthon"==R&&z)z=z.replace(/\.[\d.]+/,".x");else if(/\bXbox\b/i.test(B))"Xbox 360"==B&&(U=null),"Xbox 360"==B&&/\bIEMobile\b/.test(t)&&E.unshift("mobile mode");else if(!/^(?:Chrome|IE|Opera)$/.test(R)&&(!R||B||/Browser|Mobi/.test(R))||"Windows CE"!=U&&!/Mobi/i.test(t))if("IE"==R&&M)try{null===n.external&&E.unshift("platform preview")}catch(e){E.unshift("embedded")}else(/\bBlackBerry\b/.test(B)||/\bBB10\b/.test(t))&&(o=(RegExp(B.replace(/ +/g," *")+"/([.\\d]+)","i").exec(t)||0)[1]||z)?(U=((o=[o,/BB10/.test(t)])[1]?(B=null,q="BlackBerry"):"Device Software")+" "+o[0],z=null):this!=g&&"Wii"!=B&&(M&&P||/Opera/.test(R)&&/\b(?:MSIE|Firefox)\b/i.test(t)||"Firefox"==R&&/\bOS X (?:\d+\.){2,}/.test(U)||"IE"==R&&(U&&!/^Win/.test(U)&&z>5.5||/\bWindows XP\b/.test(U)&&z>8||8==z&&!/\bTrident\b/.test(t)))&&!h.test(o=e.call(g,t.replace(h,"")+";"))&&o.name&&(o="ing as "+o.name+((o=o.version)?" "+o:""),h.test(R)?(/\bIE\b/.test(o)&&"Mac OS"==U&&(U=null),o="identify"+o):(o="mask"+o,R=F?m(F.replace(/([a-z])([A-Z])/g,"$1 $2")):"Opera",/\bIE\b/.test(o)&&(U=null),M||(z=null)),D=["Presto"],E.push(o));else R+=" Mobile";(o=(/\bAppleWebKit\/([\d.]+\+?)/i.exec(t)||0)[1])&&(o=[parseFloat(o.replace(/\.(\d)$/,".0$1")),o],"Safari"==R&&"+"==o[1].slice(-1)?(R="WebKit Nightly",N="alpha",z=o[1].slice(0,-1)):z!=o[1]&&z!=(o[2]=(/\bSafari\/([\d.]+\+?)/i.exec(t)||0)[1])||(z=null),o[1]=(/\bChrome\/([\d.]+)/i.exec(t)||0)[1],537.36==o[0]&&537.36==o[2]&&parseFloat(o[1])>=28&&"WebKit"==D&&(D=["Blink"]),M&&(d||o[1])?(D&&(D[1]="like Chrome"),o=o[1]||((o=o[0])<530?1:o<532?2:o<532.05?3:o<533?4:o<534.03?5:o<534.07?6:o<534.1?7:o<534.13?8:o<534.16?9:o<534.24?10:o<534.3?11:o<535.01?12:o<535.02?"13+":o<535.07?15:o<535.11?16:o<535.19?17:o<536.05?18:o<536.1?19:o<537.01?20:o<537.11?"21+":o<537.13?23:o<537.18?24:o<537.24?25:o<537.36?26:"Blink"!=D?"27":"28")):(D&&(D[1]="like Safari"),o=(o=o[0])<400?1:o<500?2:o<526?3:o<533?4:o<534?"4+":o<535?5:o<537?6:o<538?7:o<601?8:"8"),D&&(D[1]+=" "+(o+="number"==typeof o?".x":/[.+]/.test(o)?"":"+")),"Safari"==R&&(!z||parseInt(z)>45)&&(z=o)),"Opera"==R&&(o=/\bzbov|zvav$/.exec(U))?(R+=" ",E.unshift("desktop mode"),"zvav"==o?(R+="Mini",z=null):R+="Mobile",U=U.replace(RegExp(" *"+o+"$"),"")):"Safari"==R&&/\bChrome\b/.exec(D&&D[1])&&(E.unshift("desktop mode"),R="Chrome Mobile",z=null,/\bOS X\b/.test(U)?(q="Apple",U="iOS 4.3+"):U=null),z&&0==z.indexOf(o=/[\d.]+$/.exec(U))&&t.indexOf("/"+o+"-")>-1&&(U=k(U.replace(o,""))),D&&!/\b(?:Avant|Nook)\b/.test(R)&&(/Browser|Lunascape|Maxthon/.test(R)||"Safari"!=R&&/^iOS/.test(U)&&/\bSafari\b/.test(D[1])||/^(?:Adobe|Arora|Breach|Midori|Opera|Phantom|Rekonq|Rock|Samsung Internet|Sleipnir|Web)/.test(R)&&D[1])&&(o=D[D.length-1])&&E.push(o),E.length&&(E=["("+E.join("; ")+")"]),q&&B&&B.indexOf(q)<0&&E.push("on "+q),B&&E.push((/^on /.test(E[E.length-1])?"":"on ")+B),U&&(o=/ ([\d.+]+)$/.exec(U),c=o&&"/"==U.charAt(U.length-o[0].length-1),U={architecture:32,family:o&&!c?U.replace(o[0],""):U,version:o?o[1]:null,toString:function(){var e=this.version;return this.family+(e&&!c?" "+e:"")+(64==this.architecture?" 64-bit":"")}}),(o=/\b(?:AMD|IA|Win|WOW|x86_|x)64\b/i.exec(I))&&!/\bi686\b/i.test(I)?(U&&(U.architecture=64,U.family=U.family.replace(RegExp(" *"+o),"")),R&&(/\bWOW64\b/i.test(t)||M&&/\w(?:86|32)$/.test(s.cpuClass||s.platform)&&!/\bWin64; x64\b/i.test(t))&&E.unshift("32-bit")):U&&/^OS X/.test(U.family)&&"Chrome"==R&&parseFloat(z)>=39&&(U.architecture=64),t||(t=null);var W={};return W.description=t,W.layout=D&&D[0],W.manufacturer=q,W.name=R,W.prerelease=N,W.product=B,W.ua=t,W.version=R&&z,W.os=U||{architecture:null,family:null,version:null,toString:function(){return"null"}},W.parse=e,W.toString=function(){return this.description||""},W.version&&E.unshift(z),W.name&&E.unshift(R),U&&R&&(U!=String(U).split(" ")[0]||U!=R.split(" ")[0]&&!B)&&E.push(B?"("+U+")":"on "+U),E.length&&(W.description=E.join(" ")),W}();i.platform=O,void 0===(s=function(){return O}.call(t,n,t,e))||(e.exports=s)}).call(this)}).call(this,n(24)(e),n(9))},function(e,t){e.exports=function(e){return e.webpackPolyfill||(e.deprecate=function(){},e.paths=[],e.children||(e.children=[]),Object.defineProperty(e,"loaded",{enumerable:!0,get:function(){return e.l}}),Object.defineProperty(e,"id",{enumerable:!0,get:function(){return e.i}}),e.webpackPolyfill=1),e}},function(e,t,n){var r,s,a;!function(i,o){"use strict";s=[n(26)],void 0===(a="function"==typeof(r=function(e){var t=/(^|@)\S+\:\d+/,n=/^\s*at .*(\S+\:\d+|\(native\))/m,r=/^(eval@)?(\[native code\])?$/;return{parse:function(e){if(void 0!==e.stacktrace||void 0!==e["opera#sourceloc"])return this.parseOpera(e);if(e.stack&&e.stack.match(n))return this.parseV8OrIE(e);if(e.stack)return this.parseFFOrSafari(e);throw new Error("Cannot parse given Error object")},extractLocation:function(e){if(-1===e.indexOf(":"))return[e];var t=/(.+?)(?:\:(\d+))?(?:\:(\d+))?$/.exec(e.replace(/[\(\)]/g,""));return[t[1],t[2]||void 0,t[3]||void 0]},parseV8OrIE:function(t){return t.stack.split("\n").filter((function(e){return!!e.match(n)}),this).map((function(t){t.indexOf("(eval ")>-1&&(t=t.replace(/eval code/g,"eval").replace(/(\(eval at [^\()]*)|(\)\,.*$)/g,""));var n=t.replace(/^\s+/,"").replace(/\(eval code/g,"("),r=n.match(/ (\((.+):(\d+):(\d+)\)$)/),s=(n=r?n.replace(r[0],""):n).split(/\s+/).slice(1),a=this.extractLocation(r?r[1]:s.pop()),i=s.join(" ")||void 0,o=["eval","<anonymous>"].indexOf(a[0])>-1?void 0:a[0];return new e({functionName:i,fileName:o,lineNumber:a[1],columnNumber:a[2],source:t})}),this)},parseFFOrSafari:function(t){return t.stack.split("\n").filter((function(e){return!e.match(r)}),this).map((function(t){if(t.indexOf(" > eval")>-1&&(t=t.replace(/ line (\d+)(?: > eval line \d+)* > eval\:\d+\:\d+/g,":$1")),-1===t.indexOf("@")&&-1===t.indexOf(":"))return new e({functionName:t});var n=/((.*".+"[^@]*)?[^@]*)(?:@)/,r=t.match(n),s=r&&r[1]?r[1]:void 0,a=this.extractLocation(t.replace(n,""));return new e({functionName:s,fileName:a[0],lineNumber:a[1],columnNumber:a[2],source:t})}),this)},parseOpera:function(e){return!e.stacktrace||e.message.indexOf("\n")>-1&&e.message.split("\n").length>e.stacktrace.split("\n").length?this.parseOpera9(e):e.stack?this.parseOpera11(e):this.parseOpera10(e)},parseOpera9:function(t){for(var n=/Line (\d+).*script (?:in )?(\S+)/i,r=t.message.split("\n"),s=[],a=2,i=r.length;a<i;a+=2){var o=n.exec(r[a]);o&&s.push(new e({fileName:o[2],lineNumber:o[1],source:r[a]}))}return s},parseOpera10:function(t){for(var n=/Line (\d+).*script (?:in )?(\S+)(?:: In function (\S+))?$/i,r=t.stacktrace.split("\n"),s=[],a=0,i=r.length;a<i;a+=2){var o=n.exec(r[a]);o&&s.push(new e({functionName:o[3]||void 0,fileName:o[2],lineNumber:o[1],source:r[a]}))}return s},parseOpera11:function(n){return n.stack.split("\n").filter((function(e){return!!e.match(t)&&!e.match(/^Error created at/)}),this).map((function(t){var n,r=t.split("@"),s=this.extractLocation(r.pop()),a=r.shift()||"",i=a.replace(/<anonymous function(: (\w+))?>/,"$2").replace(/\([^\)]*\)/g,"")||void 0;a.match(/\(([^\)]*)\)/)&&(n=a.replace(/^[^\(]+\(([^\)]*)\)$/,"$1"));var o=void 0===n||"[arguments not available]"===n?void 0:n.split(",");return new e({functionName:i,args:o,fileName:s[0],lineNumber:s[1],columnNumber:s[2],source:t})}),this)}}})?r.apply(t,s):r)||(e.exports=a)}()},function(e,t,n){var r,s,a;!function(n,i){"use strict";s=[],void 0===(a="function"==typeof(r=function(){function e(e){return e.charAt(0).toUpperCase()+e.substring(1)}function t(e){return function(){return this[e]}}var n=["isConstructor","isEval","isNative","isToplevel"],r=["columnNumber","lineNumber"],s=["fileName","functionName","source"],a=n.concat(r,s,["args"]);function i(t){if(t instanceof Object)for(var n=0;n<a.length;n++)t.hasOwnProperty(a[n])&&void 0!==t[a[n]]&&this["set"+e(a[n])](t[a[n]])}i.prototype={getArgs:function(){return this.args},setArgs:function(e){if("[object Array]"!==Object.prototype.toString.call(e))throw new TypeError("Args must be an Array");this.args=e},getEvalOrigin:function(){return this.evalOrigin},setEvalOrigin:function(e){if(e instanceof i)this.evalOrigin=e;else{if(!(e instanceof Object))throw new TypeError("Eval Origin must be an Object or StackFrame");this.evalOrigin=new i(e)}},toString:function(){var e=this.getFileName()||"",t=this.getLineNumber()||"",n=this.getColumnNumber()||"",r=this.getFunctionName()||"";return this.getIsEval()?e?"[eval] ("+e+":"+t+":"+n+")":"[eval]:"+t+":"+n:r?r+" ("+e+":"+t+":"+n+")":e+":"+t+":"+n}},i.fromString=function(e){var t=e.indexOf("("),n=e.lastIndexOf(")"),r=e.substring(0,t),s=e.substring(t+1,n).split(","),a=e.substring(n+1);if(0===a.indexOf("@"))var o=/@(.+?)(?::(\d+))?(?::(\d+))?$/.exec(a,""),c=o[1],u=o[2],l=o[3];return new i({functionName:r,args:s||void 0,fileName:c,lineNumber:u||void 0,columnNumber:l||void 0})};for(var o=0;o<n.length;o++)i.prototype["get"+e(n[o])]=t(n[o]),i.prototype["set"+e(n[o])]=function(e){return function(t){this[e]=Boolean(t)}}(n[o]);for(var c=0;c<r.length;c++)i.prototype["get"+e(r[c])]=t(r[c]),i.prototype["set"+e(r[c])]=function(e){return function(t){if(n=t,isNaN(parseFloat(n))||!isFinite(n))throw new TypeError(e+" must be a Number");var n;this[e]=Number(t)}}(r[c]);for(var u=0;u<s.length;u++)i.prototype["get"+e(s[u])]=t(s[u]),i.prototype["set"+e(s[u])]=function(e){return function(t){this[e]=String(t)}}(s[u]);return i})?r.apply(t,s):r)||(e.exports=a)}()},function(e,t){e.exports="object"==typeof self?self.FormData:window.FormData},function(e,t,n){var r=n(29),s=n(30),a=[n(37)];e.exports=r.createStore(s,a)},function(e,t,n){var r=n(3),s=r.slice,a=r.pluck,i=r.each,o=r.bind,c=r.create,u=r.isList,l=r.isFunction,h=r.isObject;e.exports={createStore:d};var p={version:"2.0.12",enabled:!1,get:function(e,t){var n=this.storage.read(this._namespacePrefix+e);return this._deserialize(n,t)},set:function(e,t){return void 0===t?this.remove(e):(this.storage.write(this._namespacePrefix+e,this._serialize(t)),t)},remove:function(e){this.storage.remove(this._namespacePrefix+e)},each:function(e){var t=this;this.storage.each((function(n,r){e.call(t,t._deserialize(n),(r||"").replace(t._namespaceRegexp,""))}))},clearAll:function(){this.storage.clearAll()},hasNamespace:function(e){return this._namespacePrefix=="__storejs_"+e+"_"},createStore:function(){return d.apply(this,arguments)},addPlugin:function(e){this._addPlugin(e)},namespace:function(e){return d(this.storage,this.plugins,e)}};function d(e,t,n){n||(n=""),e&&!u(e)&&(e=[e]),t&&!u(t)&&(t=[t]);var r=n?"__storejs_"+n+"_":"",d=n?new RegExp("^"+r):null;if(!/^[a-zA-Z0-9_\-]*$/.test(n))throw new Error("store.js namespaces can only have alphanumerics + underscores and dashes");var f=c({_namespacePrefix:r,_namespaceRegexp:d,_testStorage:function(e){try{var t="__storejs__test__";e.write(t,t);var n=e.read(t)===t;return e.remove(t),n}catch(e){return!1}},_assignPluginFnProp:function(e,t){var n=this[t];this[t]=function(){var t=s(arguments,0),r=this;function a(){if(n)return i(arguments,(function(e,n){t[n]=e})),n.apply(r,t)}var o=[a].concat(t);return e.apply(r,o)}},_serialize:function(e){return JSON.stringify(e)},_deserialize:function(e,t){if(!e)return t;var n="";try{n=JSON.parse(e)}catch(t){n=e}return void 0!==n?n:t},_addStorage:function(e){this.enabled||this._testStorage(e)&&(this.storage=e,this.enabled=!0)},_addPlugin:function(e){var t=this;if(u(e))i(e,(function(e){t._addPlugin(e)}));else if(!a(this.plugins,(function(t){return e===t}))){if(this.plugins.push(e),!l(e))throw new Error("Plugins must be function values that return objects");var n=e.call(this);if(!h(n))throw new Error("Plugins must return an object of function properties");i(n,(function(n,r){if(!l(n))throw new Error("Bad plugin property: "+r+" from plugin "+e.name+". Plugins should only return functions.");t._assignPluginFnProp(n,r)}))}},addStorage:function(e){!function(){var e="undefined"==typeof console?null:console;e&&(e.warn?e.warn:e.log).apply(e,arguments)}("store.addStorage(storage) is deprecated. Use createStore([storages])"),this._addStorage(e)}},p,{plugins:[]});return f.raw={},i(f,(function(e,t){l(e)&&(f.raw[t]=o(f,e))})),i(e,(function(e){f._addStorage(e)})),i(t,(function(e){f._addPlugin(e)})),f}},function(e,t,n){e.exports=[n(31),n(32),n(33),n(34),n(35),n(36)]},function(e,t,n){var r=n(3).Global;function s(){return r.localStorage}function a(e){return s().getItem(e)}e.exports={name:"localStorage",read:a,write:function(e,t){return s().setItem(e,t)},each:function(e){for(var t=s().length-1;t>=0;t--){var n=s().key(t);e(a(n),n)}},remove:function(e){return s().removeItem(e)},clearAll:function(){return s().clear()}}},function(e,t,n){var r=n(3).Global;e.exports={name:"oldFF-globalStorage",read:function(e){return s[e]},write:function(e,t){s[e]=t},each:a,remove:function(e){return s.removeItem(e)},clearAll:function(){a((function(e,t){delete s[e]}))}};var s=r.globalStorage;function a(e){for(var t=s.length-1;t>=0;t--){var n=s.key(t);e(s[n],n)}}},function(e,t,n){var r=n(3).Global;e.exports={name:"oldIE-userDataStorage",write:function(e,t){if(o)return;var n=u(e);i((function(e){e.setAttribute(n,t),e.save(s)}))},read:function(e){if(o)return;var t=u(e),n=null;return i((function(e){n=e.getAttribute(t)})),n},each:function(e){i((function(t){for(var n=t.XMLDocument.documentElement.attributes,r=n.length-1;r>=0;r--){var s=n[r];e(t.getAttribute(s.name),s.name)}}))},remove:function(e){var t=u(e);i((function(e){e.removeAttribute(t),e.save(s)}))},clearAll:function(){i((function(e){var t=e.XMLDocument.documentElement.attributes;e.load(s);for(var n=t.length-1;n>=0;n--)e.removeAttribute(t[n].name);e.save(s)}))}};var s="storejs",a=r.document,i=function(){if(!a||!a.documentElement||!a.documentElement.addBehavior)return null;var e,t,n;try{(t=new ActiveXObject("htmlfile")).open(),t.write('<script>document.w=window<\/script><iframe src="/favicon.ico"></iframe>'),t.close(),e=t.w.frames[0].document,n=e.createElement("div")}catch(t){n=a.createElement("div"),e=a.body}return function(t){var r=[].slice.call(arguments,0);r.unshift(n),e.appendChild(n),n.addBehavior("#default#userData"),n.load(s),t.apply(this,r),e.removeChild(n)}}(),o=(r.navigator?r.navigator.userAgent:"").match(/ (MSIE 8|MSIE 9|MSIE 10)\./);var c=new RegExp("[!\"#$%&'()*+,/\\\\:;<=>?@[\\]^`{|}~]","g");function u(e){return e.replace(/^\d/,"___$&").replace(c,"___")}},function(e,t,n){var r=n(3),s=r.Global,a=r.trim;e.exports={name:"cookieStorage",read:function(e){if(!e||!u(e))return null;var t="(?:^|.*;\\s*)"+escape(e).replace(/[\-\.\+\*]/g,"\\$&")+"\\s*\\=\\s*((?:[^;](?!;))*[^;]?).*";return unescape(i.cookie.replace(new RegExp(t),"$1"))},write:function(e,t){if(!e)return;i.cookie=escape(e)+"="+escape(t)+"; expires=Tue, 19 Jan 2038 03:14:07 GMT; path=/"},each:o,remove:c,clearAll:function(){o((function(e,t){c(t)}))}};var i=s.document;function o(e){for(var t=i.cookie.split(/; ?/g),n=t.length-1;n>=0;n--)if(a(t[n])){var r=t[n].split("="),s=unescape(r[0]);e(unescape(r[1]),s)}}function c(e){e&&u(e)&&(i.cookie=escape(e)+"=; expires=Thu, 01 Jan 1970 00:00:00 GMT; path=/")}function u(e){return new RegExp("(?:^|;\\s*)"+escape(e).replace(/[\-\.\+\*]/g,"\\$&")+"\\s*\\=").test(i.cookie)}},function(e,t,n){var r=n(3).Global;function s(){return r.sessionStorage}function a(e){return s().getItem(e)}e.exports={name:"sessionStorage",read:a,write:function(e,t){return s().setItem(e,t)},each:function(e){for(var t=s().length-1;t>=0;t--){var n=s().key(t);e(a(n),n)}},remove:function(e){return s().removeItem(e)},clearAll:function(){return s().clear()}}},function(e,t){e.exports={name:"memoryStorage",read:function(e){return n[e]},write:function(e,t){n[e]=t},each:function(e){for(var t in n)n.hasOwnProperty(t)&&e(n[t],t)},remove:function(e){delete n[e]},clearAll:function(e){n={}}};var n={}},function(e,t,n){e.exports=function(){return n(38),{}}},function(module,exports){"object"!=typeof JSON&&(JSON={}),function(){"use strict";var rx_one=/^[\],:{}\s]*$/,rx_two=/\\(?:["\\\/bfnrt]|u[0-9a-fA-F]{4})/g,rx_three=/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,rx_four=/(?:^|:|,)(?:\s*\[)+/g,rx_escapable=/[\\"\u0000-\u001f\u007f-\u009f\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,rx_dangerous=/[\u0000\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,gap,indent,meta,rep;function f(e){return e<10?"0"+e:e}function this_value(){return this.valueOf()}function quote(e){return rx_escapable.lastIndex=0,rx_escapable.test(e)?'"'+e.replace(rx_escapable,(function(e){var t=meta[e];return"string"==typeof t?t:"\\u"+("0000"+e.charCodeAt(0).toString(16)).slice(-4)}))+'"':'"'+e+'"'}function str(e,t){var n,r,s,a,i,o=gap,c=t[e];switch(c&&"object"==typeof c&&"function"==typeof c.toJSON&&(c=c.toJSON(e)),"function"==typeof rep&&(c=rep.call(t,e,c)),typeof c){case"string":return quote(c);case"number":return isFinite(c)?String(c):"null";case"boolean":case"null":return String(c);case"object":if(!c)return"null";if(gap+=indent,i=[],"[object Array]"===Object.prototype.toString.apply(c)){for(a=c.length,n=0;n<a;n+=1)i[n]=str(n,c)||"null";return s=0===i.length?"[]":gap?"[\n"+gap+i.join(",\n"+gap)+"\n"+o+"]":"["+i.join(",")+"]",gap=o,s}if(rep&&"object"==typeof rep)for(a=rep.length,n=0;n<a;n+=1)"string"==typeof rep[n]&&(s=str(r=rep[n],c))&&i.push(quote(r)+(gap?": ":":")+s);else for(r in c)Object.prototype.hasOwnProperty.call(c,r)&&(s=str(r,c))&&i.push(quote(r)+(gap?": ":":")+s);return s=0===i.length?"{}":gap?"{\n"+gap+i.join(",\n"+gap)+"\n"+o+"}":"{"+i.join(",")+"}",gap=o,s}}"function"!=typeof Date.prototype.toJSON&&(Date.prototype.toJSON=function(){return isFinite(this.valueOf())?this.getUTCFullYear()+"-"+f(this.getUTCMonth()+1)+"-"+f(this.getUTCDate())+"T"+f(this.getUTCHours())+":"+f(this.getUTCMinutes())+":"+f(this.getUTCSeconds())+"Z":null},Boolean.prototype.toJSON=this_value,Number.prototype.toJSON=this_value,String.prototype.toJSON=this_value),"function"!=typeof JSON.stringify&&(meta={"\b":"\\b","\t":"\\t","\n":"\\n","\f":"\\f","\r":"\\r",'"':'\\"',"\\":"\\\\"},JSON.stringify=function(e,t,n){var r;if(gap="",indent="","number"==typeof n)for(r=0;r<n;r+=1)indent+=" ";else"string"==typeof n&&(indent=n);if(rep=t,t&&"function"!=typeof t&&("object"!=typeof t||"number"!=typeof t.length))throw new Error("JSON.stringify");return str("",{"":e})}),"function"!=typeof JSON.parse&&(JSON.parse=function(text,reviver){var j;function walk(e,t){var n,r,s=e[t];if(s&&"object"==typeof s)for(n in s)Object.prototype.hasOwnProperty.call(s,n)&&(void 0!==(r=walk(s,n))?s[n]=r:delete s[n]);return reviver.call(e,t,s)}if(text=String(text),rx_dangerous.lastIndex=0,rx_dangerous.test(text)&&(text=text.replace(rx_dangerous,(function(e){return"\\u"+("0000"+e.charCodeAt(0).toString(16)).slice(-4)}))),rx_one.test(text.replace(rx_two,"@").replace(rx_three,"]").replace(rx_four,"")))return j=eval("("+text+")"),"function"==typeof reviver?walk({"":j},""):j;throw new SyntaxError("JSON.parse")})}()},function(e,t,n){e.exports=n(40)},function(e,t,n){"use strict";var r=n(1),s=n(14),a=n(42),i=n(11);function o(e){var t=new a(e),n=s(a.prototype.request,t);return r.extend(n,a.prototype,t),r.extend(n,t),n}var c=o(i);c.Axios=a,c.create=function(e){return o(r.merge(i,e))},c.Cancel=n(19),c.CancelToken=n(55),c.isCancel=n(18),c.all=function(e){return Promise.all(e)},c.spread=n(56),e.exports=c,e.exports.default=c},function(e,t){
/*!
 * Determine if an object is a Buffer
 *
 * @author   Feross Aboukhadijeh <https://feross.org>
 * @license  MIT
 */
e.exports=function(e){return null!=e&&null!=e.constructor&&"function"==typeof e.constructor.isBuffer&&e.constructor.isBuffer(e)}},function(e,t,n){"use strict";var r=n(11),s=n(1),a=n(50),i=n(51);function o(e){this.defaults=e,this.interceptors={request:new a,response:new a}}o.prototype.request=function(e){"string"==typeof e&&(e=s.merge({url:arguments[0]},arguments[1])),(e=s.merge(r,{method:"get"},this.defaults,e)).method=e.method.toLowerCase();var t=[i,void 0],n=Promise.resolve(e);for(this.interceptors.request.forEach((function(e){t.unshift(e.fulfilled,e.rejected)})),this.interceptors.response.forEach((function(e){t.push(e.fulfilled,e.rejected)}));t.length;)n=n.then(t.shift(),t.shift());return n},s.forEach(["delete","get","head","options"],(function(e){o.prototype[e]=function(t,n){return this.request(s.merge(n||{},{method:e,url:t}))}})),s.forEach(["post","put","patch"],(function(e){o.prototype[e]=function(t,n,r){return this.request(s.merge(r||{},{method:e,url:t,data:n}))}})),e.exports=o},function(e,t,n){"use strict";var r=n(1);e.exports=function(e,t){r.forEach(e,(function(n,r){r!==t&&r.toUpperCase()===t.toUpperCase()&&(e[t]=n,delete e[r])}))}},function(e,t,n){"use strict";var r=n(17);e.exports=function(e,t,n){var s=n.config.validateStatus;n.status&&s&&!s(n.status)?t(r("Request failed with status code "+n.status,n.config,null,n.request,n)):e(n)}},function(e,t,n){"use strict";e.exports=function(e,t,n,r,s){return e.config=t,n&&(e.code=n),e.request=r,e.response=s,e}},function(e,t,n){"use strict";var r=n(1);function s(e){return encodeURIComponent(e).replace(/%40/gi,"@").replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%20/g,"+").replace(/%5B/gi,"[").replace(/%5D/gi,"]")}e.exports=function(e,t,n){if(!t)return e;var a;if(n)a=n(t);else if(r.isURLSearchParams(t))a=t.toString();else{var i=[];r.forEach(t,(function(e,t){null!=e&&(r.isArray(e)?t+="[]":e=[e],r.forEach(e,(function(e){r.isDate(e)?e=e.toISOString():r.isObject(e)&&(e=JSON.stringify(e)),i.push(s(t)+"="+s(e))})))})),a=i.join("&")}return a&&(e+=(-1===e.indexOf("?")?"?":"&")+a),e}},function(e,t,n){"use strict";var r=n(1),s=["age","authorization","content-length","content-type","etag","expires","from","host","if-modified-since","if-unmodified-since","last-modified","location","max-forwards","proxy-authorization","referer","retry-after","user-agent"];e.exports=function(e){var t,n,a,i={};return e?(r.forEach(e.split("\n"),(function(e){if(a=e.indexOf(":"),t=r.trim(e.substr(0,a)).toLowerCase(),n=r.trim(e.substr(a+1)),t){if(i[t]&&s.indexOf(t)>=0)return;i[t]="set-cookie"===t?(i[t]?i[t]:[]).concat([n]):i[t]?i[t]+", "+n:n}})),i):i}},function(e,t,n){"use strict";var r=n(1);e.exports=r.isStandardBrowserEnv()?function(){var e,t=/(msie|trident)/i.test(navigator.userAgent),n=document.createElement("a");function s(e){var r=e;return t&&(n.setAttribute("href",r),r=n.href),n.setAttribute("href",r),{href:n.href,protocol:n.protocol?n.protocol.replace(/:$/,""):"",host:n.host,search:n.search?n.search.replace(/^\?/,""):"",hash:n.hash?n.hash.replace(/^#/,""):"",hostname:n.hostname,port:n.port,pathname:"/"===n.pathname.charAt(0)?n.pathname:"/"+n.pathname}}return e=s(window.location.href),function(t){var n=r.isString(t)?s(t):t;return n.protocol===e.protocol&&n.host===e.host}}():function(){return!0}},function(e,t,n){"use strict";var r=n(1);e.exports=r.isStandardBrowserEnv()?{write:function(e,t,n,s,a,i){var o=[];o.push(e+"="+encodeURIComponent(t)),r.isNumber(n)&&o.push("expires="+new Date(n).toGMTString()),r.isString(s)&&o.push("path="+s),r.isString(a)&&o.push("domain="+a),!0===i&&o.push("secure"),document.cookie=o.join("; ")},read:function(e){var t=document.cookie.match(new RegExp("(^|;\\s*)("+e+")=([^;]*)"));return t?decodeURIComponent(t[3]):null},remove:function(e){this.write(e,"",Date.now()-864e5)}}:{write:function(){},read:function(){return null},remove:function(){}}},function(e,t,n){"use strict";var r=n(1);function s(){this.handlers=[]}s.prototype.use=function(e,t){return this.handlers.push({fulfilled:e,rejected:t}),this.handlers.length-1},s.prototype.eject=function(e){this.handlers[e]&&(this.handlers[e]=null)},s.prototype.forEach=function(e){r.forEach(this.handlers,(function(t){null!==t&&e(t)}))},e.exports=s},function(e,t,n){"use strict";var r=n(1),s=n(52),a=n(18),i=n(11),o=n(53),c=n(54);function u(e){e.cancelToken&&e.cancelToken.throwIfRequested()}e.exports=function(e){return u(e),e.baseURL&&!o(e.url)&&(e.url=c(e.baseURL,e.url)),e.headers=e.headers||{},e.data=s(e.data,e.headers,e.transformRequest),e.headers=r.merge(e.headers.common||{},e.headers[e.method]||{},e.headers||{}),r.forEach(["delete","get","head","post","put","patch","common"],(function(t){delete e.headers[t]})),(e.adapter||i.adapter)(e).then((function(t){return u(e),t.data=s(t.data,t.headers,e.transformResponse),t}),(function(t){return a(t)||(u(e),t&&t.response&&(t.response.data=s(t.response.data,t.response.headers,e.transformResponse))),Promise.reject(t)}))}},function(e,t,n){"use strict";var r=n(1);e.exports=function(e,t,n){return r.forEach(n,(function(n){e=n(e,t)})),e}},function(e,t,n){"use strict";e.exports=function(e){return/^([a-z][a-z\d\+\-\.]*:)?\/\//i.test(e)}},function(e,t,n){"use strict";e.exports=function(e,t){return t?e.replace(/\/+$/,"")+"/"+t.replace(/^\/+/,""):e}},function(e,t,n){"use strict";var r=n(19);function s(e){if("function"!=typeof e)throw new TypeError("executor must be a function.");var t;this.promise=new Promise((function(e){t=e}));var n=this;e((function(e){n.reason||(n.reason=new r(e),t(n.reason))}))}s.prototype.throwIfRequested=function(){if(this.reason)throw this.reason},s.source=function(){var e;return{token:new s((function(t){e=t})),cancel:e}},e.exports=s},function(e,t,n){"use strict";e.exports=function(e){return function(t){return e.apply(null,t)}}},function(e,t,n){(function(t){(()=>{const r=n(58),s=n(5),a=n(2),{isBrowser:i,isNode:o}=n(62),{Exception:c,ArgumentError:u}=n(0),l={};class h{constructor(e,t,n,r,s,a,i){Object.defineProperties(this,Object.freeze({width:{value:e,writable:!1},height:{value:t,writable:!1},tid:{value:n,writable:!1},number:{value:r,writable:!1},startFrame:{value:s,writable:!1},stopFrame:{value:a,writable:!1},decodeForward:{value:i,writable:!1}}))}async data(e=(()=>{})){return await s.apiWrapper.call(this,h.prototype.data,e)}}h.prototype.data.implementation=async function(e){return new Promise((t,n)=>{const r=e=>(this._data=e,t(this._data));if(this._data)return void t(this._data);const{provider:s}=l[this.tid],{chunkSize:u}=l[this.tid],h=Math.max(this.startFrame,parseInt(this.number/u,10)*u),p=Math.min(this.stopFrame,(parseInt(this.number/u,10)+1)*u-1),d=Math.floor(this.number/u),f=async e=>{if(l[this.tid].activeChunkRequest&&d===l[this.tid].activeChunkRequest.chunkNumber){const t=l[this.tid].activeChunkRequest.callbacks;for(let n=t.length-1;n>=0;--n)if(t[n].frameNumber===e){const e=t[n];t.splice(n,1),e.resolve(await s.frame(e.frameNumber))}0===t.length&&(l[this.tid].activeChunkRequest=null)}},b=()=>{if(l[this.tid].activeChunkRequest&&d===l[this.tid].activeChunkRequest.chunkNumber){for(const e of l[this.tid].activeChunkRequest.callbacks)e.reject(e.frameNumber);l[this.tid].activeChunkRequest=null}},m=()=>{const e=l[this.tid],t=e.activeChunkRequest;t.request=a.frames.getData(this.tid,t.chunkNumber).then(t=>{l[this.tid].activeChunkRequest.completed=!0,e.nextChunkRequest||s.requestDecodeBlock(t,e.activeChunkRequest.start,e.activeChunkRequest.stop,e.activeChunkRequest.onDecodeAll,e.activeChunkRequest.rejectRequestAll)}).catch(e=>{n(e instanceof c?e:new c(e.message))}).finally(()=>{if(e.nextChunkRequest){if(e.activeChunkRequest)for(const t of e.activeChunkRequest.callbacks)t.reject(t.frameNumber);e.activeChunkRequest=e.nextChunkRequest,e.nextChunkRequest=null,m()}})};o?t("Dummy data"):i&&s.frame(this.number).then(t=>{if(null===t)if(e(),s.isChunkCached(h,p))l[this.tid].activeChunkRequest.callbacks.push({resolve:r,reject:n,frameNumber:this.number}),s.requestDecodeBlock(null,h,p,f,b);else if(!l[this.tid].activeChunkRequest||l[this.tid].activeChunkRequest&&l[this.tid].activeChunkRequest.completed&&l[this.tid].activeChunkRequest.chunkNumber!==d){const e=l[this.tid].activeChunkRequest;e&&e.rejectRequestAll&&e.rejectRequestAll(),l[this.tid].activeChunkRequest={request:null,chunkNumber:d,start:h,stop:p,onDecodeAll:f,rejectRequestAll:b,completed:!1,callbacks:[{resolve:r,reject:n,frameNumber:this.number}]},m()}else if(l[this.tid].activeChunkRequest.chunkNumber===d)l[this.tid].activeChunkRequest.callbacks.push({resolve:r,reject:n,frameNumber:this.number});else{if(l[this.tid].nextChunkRequest){const{callbacks:e}=l[this.tid].nextChunkRequest;for(const t of e)t.reject(t.frameNumber)}l[this.tid].nextChunkRequest={request:null,chunkNumber:d,start:h,stop:p,onDecodeAll:f,rejectRequestAll:b,completed:!1,callbacks:[{resolve:r,reject:n,frameNumber:this.number}]}}else{if(this.number%u>u/4&&s.decodedBlocksCacheSize>1&&this.decodeForward&&!s.isNextChunkExists(this.number)){const e=Math.floor(this.number/u)+1;if(e*u<this.stopFrame){s.setReadyToLoading(e);const t=e*u,n=(e+1)*u-1;s.isChunkCached(t,n)?s.requestDecodeBlock(null,t,n,null,null):l[this.tid].activeChunkRequest||(l[this.tid].activeChunkRequest={request:null,chunkNumber:e,start:t,stop:n,onDecodeAll:null,rejectRequestAll:null,completed:!1,callbacks:[]},m())}}r(t)}}).catch(e=>{n(e instanceof c?e:new c(e.message))})})};const p=(e,t)=>{const{meta:n,mode:r}=l[e];let s=null;if("interpolation"===r)[s]=n.frames;else{if("annotation"!==r)throw new u("Invalid mode is specified ".concat(r));if(t>=n.size)throw new u("Meta information about frame ".concat(t," can't be received from the server"));s=n.frames[t]}return s};class d{constructor(e,t,n,r){this._size=e,this._buffer={},this._requestedChunks={},this._chunkSize=t,this._stopFrame=n,this._activeFillBufferRequest=!1,this._taskID=r}getFreeBufferSize(){let e=0;for(const t of Object.values(this._requestedChunks))e+=t.requestedFrames.size;return this._size-Object.keys(this._buffer).length-e}requestOneChunkFrames(e){return new Promise((t,n)=>{this._requestedChunks[e]={...this._requestedChunks[e],resolve:t,reject:n};for(const t of this._requestedChunks[e].requestedFrames.entries()){const r=t[1],s=p(this._taskID,r),a=new h(s.width,s.height,this._taskID,r,l[this._taskID].startFrame,l[this._taskID].stopFrame);a.data().then(()=>{if(e in this._requestedChunks&&this._requestedChunks[e].requestedFrames.has(r)){if(this._requestedChunks[e].requestedFrames.delete(r),this._requestedChunks[e].buffer[r]=a,0===this._requestedChunks[e].requestedFrames.size){const t=Object.keys(this._requestedChunks[e].buffer).map(e=>+e);this._requestedChunks[e].resolve(new Set(t))}}else n(e)}).catch(()=>{n(e)})}})}fillBuffer(e,t=1,n=null){const r=this.getFreeBufferSize(),s=n?n*t:r*t,a=Math.min(e+s,this._stopFrame+1);for(let n=e;n<a;n+=t){const e=Math.floor(n/this._chunkSize);e in this._requestedChunks||(this._requestedChunks[e]={requestedFrames:new Set,resolve:null,reject:null,buffer:{}}),this._requestedChunks[e].requestedFrames.add(n)}let i=new Set;return new Promise(async(e,t)=>{for(const n in this._requestedChunks)if(Object.prototype.hasOwnProperty.call(this._requestedChunks,n))try{const r=await this.requestOneChunkFrames(n);if(!(n in this._requestedChunks)){t(n);break}i=new Set([...i,...r]),this._buffer={...this._buffer,...this._requestedChunks[n].buffer},delete this._requestedChunks[n],0===Object.keys(this._requestedChunks).length&&e(i)}catch(e){t(e);break}})}async makeFillRequest(e,t,n=null){if(!this._activeFillBufferRequest){this._activeFillBufferRequest=!0;try{await this.fillBuffer(e,t,n),this._activeFillBufferRequest=!1}catch(e){if("number"==typeof e&&e in this._requestedChunks)throw this._activeFillBufferRequest=!1,e}}}async require(e,t,n,r){for(const t in this._buffer)(t<e||t>=e+this._size*r)&&delete this._buffer[t];this._required=e;const s=p(t,e);let a=new h(s.width,s.height,t,e,l[t].startFrame,l[t].stopFrame,!n);if(e in this._buffer){a=this._buffer[e],delete this._buffer[e];const t=this.cachedFrames();if(n&&!this._activeFillBufferRequest&&this._size>this._chunkSize&&t.length<this._size/2){const n=t?Math.max(...t):e;n<this._stopFrame&&this.makeFillRequest(n+1,r)}}else if(n){this.clear();try{await this.makeFillRequest(e,r,n?null:1)}catch(e){if("not needed"!==e)throw e}a=this._buffer[e]}else this.clear();return a}clear(){for(const e in this._requestedChunks)Object.prototype.hasOwnProperty.call(this._requestedChunks,e)&&this._requestedChunks[e].reject&&this._requestedChunks[e].reject("not needed");this._activeFillBufferRequest=!1,this._requestedChunks={},this._buffer={}}cachedFrames(){return Object.keys(this._buffer).map(e=>+e)}}e.exports={FrameData:h,getFrame:async function(e,t,n,s,i,o,c,u,h){if(!(e in l)){const u="video"===n?r.BlockType.MP4VIDEO:r.BlockType.ARCHIVE,h=await a.frames.getMeta(e),f=h.frames.reduce((e,t)=>e+t.width*t.height,0)/h.frames.length,b=Math.sqrt(h.frames.map(e=>Math.pow(e.width*e.height-f,2)).reduce((e,t)=>e+t)/h.frames.length),m=Math.floor(2147483648/(f+b)/4/t)||1;l[e]={meta:h,chunkSize:t,mode:s,startFrame:o,stopFrame:c,provider:new r.FrameProvider(u,t,Math.max(m,9),m,1),frameBuffer:new d(Math.min(180,m*t),t,c,e),decodedBlocksCacheSize:m,activeChunkRequest:null,nextChunkRequest:null};const g=p(e,i);l[e].provider.setRenderSize(g.width,g.height)}return l[e].frameBuffer.require(i,e,u,h)},getRanges:function(e){return e in l?{decoded:l[e].provider.cachedFrames,buffered:l[e].frameBuffer.cachedFrames()}:{decoded:[],buffered:[]}},getPreview:async function(e){return new Promise((n,r)=>{a.frames.getPreview(e).then(e=>{if(o)n(t.Buffer.from(e,"binary").toString("base64"));else if(i){const t=new FileReader;t.onload=()=>{n(t.result)},t.readAsDataURL(e)}}).catch(e=>{r(e)})})}}})()}).call(this,n(9))},function(e,t,n){const{Mutex:r}=n(59),{MP4Reader:s,Bytestream:a}=n(61),i=Object.freeze({MP4VIDEO:"mp4video",ARCHIVE:"archive"});class o{constructor(e,t,n,s=5,a=2){this._frames={},this._cachedBlockCount=Math.max(1,n),this._decodedBlocksCacheSize=s,this._blocksRanges=[],this._blocks={},this._blockSize=t,this._running=!1,this._blockType=e,this._currFrame=-1,this._requestedBlockDecode=null,this._width=null,this._height=null,this._decodingBlocks={},this._decodeThreadCount=0,this._timerId=setTimeout(this._worker.bind(this),100),this._mutex=new r,this._promisedFrames={},this._maxWorkerThreadCount=a}async _worker(){null!==this._requestedBlockDecode&&this._decodeThreadCount<this._maxWorkerThreadCount&&await this.startDecode(),this._timerId=setTimeout(this._worker.bind(this),100)}isChunkCached(e,t){return"".concat(e,":").concat(t)in this._blocksRanges}async _cleanup(){if(this._blocksRanges.length>this._cachedBlockCount){const e=this._blocksRanges.shift(),[t,n]=e.split(":").map(e=>+e);delete this._blocks[t/this._blockSize];for(let e=t;e<=n;e++)delete this._frames[e]}const e=Math.floor(this._decodedBlocksCacheSize/2);for(let t=0;t<this._blocksRanges.length;t++){const[n,r]=this._blocksRanges[t].split(":").map(e=>+e);if(r<this._currFrame-e*this._blockSize||n>this._currFrame+e*this._blockSize)for(let e=n;e<=r;e++)delete this._frames[e]}}async requestDecodeBlock(e,t,n,r,s){const a=await this._mutex.acquire();try{null!==this._requestedBlockDecode&&(t===this._requestedBlockDecode.start&&n===this._requestedBlockDecode.end?(this._requestedBlockDecode.resolveCallback=r,this._requestedBlockDecode.rejectCallback=s):this._requestedBlockDecode.rejectCallback&&this._requestedBlockDecode.rejectCallback()),"".concat(t,":").concat(n)in this._decodingBlocks?(this._decodingBlocks["".concat(t,":").concat(n)].rejectCallback=s,this._decodingBlocks["".concat(t,":").concat(n)].resolveCallback=r):this._requestedBlockDecode={block:e||this._blocks[Math.floor(t/this.blockSize)],start:t,end:n,resolveCallback:r,rejectCallback:s}}finally{a()}}isRequestExist(){return null!==this._requestedBlockDecode}setRenderSize(e,t){this._width=e,this._height=t}async frame(e){return this._currFrame=e,new Promise((t,n)=>{e in this._frames?null!==this._frames[e]?t(this._frames[e]):this._promisedFrames[e]={resolve:t,reject:n}:t(null)})}isNextChunkExists(e){const t=Math.floor(e/this._blockSize)+1;return"loading"===this._blocks[t]||t in this._blocks}setReadyToLoading(e){this._blocks[e]="loading"}static cropImage(e,t,n,r,s,a,i){if(0===r&&a===t&&0===s&&i===n)return new ImageData(new Uint8ClampedArray(e),a,i);const o=new Uint32Array(e),c=a*i*4,u=new ArrayBuffer(c),l=new Uint32Array(u),h=new Uint8ClampedArray(u);if(t===a)return new ImageData(new Uint8ClampedArray(e,4*s,c),a,i);let p=0;for(let e=s;e<i;e++){const n=e*t+r;l.set(o.subarray(n,n+a),p),p+=a}return new ImageData(h,a,i)}async startDecode(){const e=await this._mutex.acquire();try{const t=this._height,n=this._width,{start:r,end:c,block:u}=this._requestedBlockDecode;this._blocksRanges.push("".concat(r,":").concat(c)),this._decodingBlocks["".concat(r,":").concat(c)]=this._requestedBlockDecode,this._requestedBlockDecode=null,this._blocks[Math.floor((r+1)/this._blockSize)]=u;for(let e=r;e<=c;e++)this._frames[e]=null;if(this._cleanup(),this._blockType===i.MP4VIDEO){const e=new Worker("/static/engine/js/3rdparty/Decoder.js");let i=r;e.onmessage=s=>{if(s.data.consoleLog)return;const a=Math.ceil(this._height/s.data.height);this._frames[i]=o.cropImage(s.data.buf,s.data.width,s.data.height,0,0,Math.floor(n/a),Math.floor(t/a)),this._decodingBlocks["".concat(r,":").concat(c)].resolveCallback&&this._decodingBlocks["".concat(r,":").concat(c)].resolveCallback(i),i in this._promisedFrames&&(this._promisedFrames[i].resolve(this._frames[i]),delete this._promisedFrames[i]),i===c&&(this._decodeThreadCount--,delete this._decodingBlocks["".concat(r,":").concat(c)],e.terminate()),i++},e.onerror=t=>{e.terminate(),this._decodeThreadCount--;for(let e=i;e<=c;e++)e in this._promisedFrames&&(this._promisedFrames[e].reject(),delete this._promisedFrames[e]);this._decodingBlocks["".concat(r,":").concat(c)].rejectCallback&&this._decodingBlocks["".concat(r,":").concat(c)].rejectCallback(Error(t)),delete this._decodingBlocks["".concat(r,":").concat(c)]},e.postMessage({type:"Broadway.js - Worker init",options:{rgb:!0,reuseMemory:!1}});const l=new s(new a(u));l.read();const h=l.tracks[1],p=l.tracks[1].trak.mdia.minf.stbl.stsd.avc1.avcC,d=p.sps[0],f=p.pps[0];e.postMessage({buf:d,offset:0,length:d.length}),e.postMessage({buf:f,offset:0,length:f.length});for(let t=0;t<h.getSampleCount();t++)h.getSampleNALUnits(t).forEach(t=>{e.postMessage({buf:t,offset:0,length:t.length})});this._decodeThreadCount++}else{const e=new Worker("/static/engine/js/unzip_imgs.js");e.onerror=t=>{for(let e=r;e<=c;e++)e in this._promisedFrames&&(this._promisedFrames[e].reject(),delete this._promisedFrames[e]);this._decodingBlocks["".concat(r,":").concat(c)].rejectCallback&&this._decodingBlocks["".concat(r,":").concat(c)].rejectCallback(Error(t)),this._decodeThreadCount--,e.terminate()},e.onmessage=t=>{this._frames[t.data.index]=t.data.data,this._decodingBlocks["".concat(r,":").concat(c)].resolveCallback&&this._decodingBlocks["".concat(r,":").concat(c)].resolveCallback(t.data.index),t.data.index in this._promisedFrames&&(this._promisedFrames[t.data.index].resolve(this._frames[t.data.index]),delete this._promisedFrames[t.data.index]),t.data.isEnd&&(e.terminate(),delete this._decodingBlocks["".concat(r,":").concat(c)],this._decodeThreadCount--)},e.postMessage({block:u,start:r,end:c}),this._decodeThreadCount++}}finally{e()}}get decodeThreadCount(){return this._decodeThreadCount}get decodedBlocksCacheSize(){return this._decodedBlocksCacheSize}get cachedFrames(){return[...this._blocksRanges].sort((e,t)=>e.split(":")[0]-t.split(":")[0])}}e.exports={FrameProvider:o,BlockType:i}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(60);t.Mutex=r.default},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(){this._queue=[],this._pending=!1}return e.prototype.isLocked=function(){return this._pending},e.prototype.acquire=function(){var e=this,t=new Promise((function(t){return e._queue.push(t)}));return this._pending||this._dispatchNext(),t},e.prototype.runExclusive=function(e){return this.acquire().then((function(t){var n;try{n=e()}catch(e){throw t(),e}return Promise.resolve(n).then((function(e){return t(),e}),(function(e){throw t(),e}))}))},e.prototype._dispatchNext=function(){this._queue.length>0?(this._pending=!0,this._queue.shift()(this._dispatchNext.bind(this))):this._pending=!1},e}();t.default=r},function(e,t){e.exports=function(){"use strict";function e(e,t){e||error(t)}var t,n,r=function(){function e(e,t){this.w=e,this.h=t}return e.prototype={toString:function(){return"("+this.w+", "+this.h+")"},getHalfSize:function(){return new r(this.w>>>1,this.h>>>1)},length:function(){return this.w*this.h}},e}(),s=function(){function t(e,t,n){this.bytes=new Uint8Array(e),this.start=t||0,this.pos=this.start,this.end=t+n||this.bytes.length}return t.prototype={get length(){return this.end-this.start},get position(){return this.pos},get remaining(){return this.end-this.pos},readU8Array:function(e){if(this.pos>this.end-e)return null;var t=this.bytes.subarray(this.pos,this.pos+e);return this.pos+=e,t},readU32Array:function(e,t,n){if(t=t||1,this.pos>this.end-e*t*4)return null;if(1==t){for(var r=new Uint32Array(e),s=0;s<e;s++)r[s]=this.readU32();return r}for(r=new Array(e),s=0;s<e;s++){var a=null;if(n){a={};for(var i=0;i<t;i++)a[n[i]]=this.readU32()}else{a=new Uint32Array(t);for(i=0;i<t;i++)a[i]=this.readU32()}r[s]=a}return r},read8:function(){return this.readU8()<<24>>24},readU8:function(){return this.pos>=this.end?null:this.bytes[this.pos++]},read16:function(){return this.readU16()<<16>>16},readU16:function(){if(this.pos>=this.end-1)return null;var e=this.bytes[this.pos+0]<<8|this.bytes[this.pos+1];return this.pos+=2,e},read24:function(){return this.readU24()<<8>>8},readU24:function(){var e=this.pos,t=this.bytes;if(e>this.end-3)return null;var n=t[e+0]<<16|t[e+1]<<8|t[e+2];return this.pos+=3,n},peek32:function(e){var t=this.pos,n=this.bytes;if(t>this.end-4)return null;var r=n[t+0]<<24|n[t+1]<<16|n[t+2]<<8|n[t+3];return e&&(this.pos+=4),r},read32:function(){return this.peek32(!0)},readU32:function(){return this.peek32(!0)>>>0},read4CC:function(){var e=this.pos;if(e>this.end-4)return null;for(var t="",n=0;n<4;n++)t+=String.fromCharCode(this.bytes[e+n]);return this.pos+=4,t},readFP16:function(){return this.read32()/65536},readFP8:function(){return this.read16()/256},readISO639:function(){for(var e=this.readU16(),t="",n=0;n<3;n++){var r=e>>>5*(2-n)&31;t+=String.fromCharCode(r+96)}return t},readUTF8:function(e){for(var t="",n=0;n<e;n++)t+=String.fromCharCode(this.readU8());return t},readPString:function(t){var n=this.readU8();e(n<=t);var r=this.readUTF8(n);return this.reserved(t-n-1,0),r},skip:function(e){this.seek(this.pos+e)},reserved:function(t,n){for(var r=0;r<t;r++)e(this.readU8()==n)},seek:function(e){(e<0||e>this.end)&&error("Index out of bounds (bounds: [0, "+this.end+"], index: "+e+")."),this.pos=e},subStream:function(e,t){return new s(this.bytes.buffer,e,t)}},t}(),a=function(){function t(e){this.stream=e,this.tracks={}}return t.prototype={readBoxes:function(e,t){for(;e.peek32();){var n=this.readBox(e);if(n.type in t){var r=t[n.type];r instanceof Array||(t[n.type]=[r]),t[n.type].push(n)}else t[n.type]=n}},readBox:function(t){var n={offset:t.position};function r(){n.version=t.readU8(),n.flags=t.readU24()}function s(){return n.size-(t.position-n.offset)}function a(){t.skip(s())}var o=function(){var e=t.subStream(t.position,s());this.readBoxes(e,n),t.skip(e.length)}.bind(this);switch(n.size=t.readU32(),n.type=t.read4CC(),n.type){case"ftyp":n.name="File Type Box",n.majorBrand=t.read4CC(),n.minorVersion=t.readU32(),n.compatibleBrands=new Array((n.size-16)/4);for(var c=0;c<n.compatibleBrands.length;c++)n.compatibleBrands[c]=t.read4CC();break;case"moov":n.name="Movie Box",o();break;case"mvhd":n.name="Movie Header Box",r(),e(0==n.version),n.creationTime=t.readU32(),n.modificationTime=t.readU32(),n.timeScale=t.readU32(),n.duration=t.readU32(),n.rate=t.readFP16(),n.volume=t.readFP8(),t.skip(10),n.matrix=t.readU32Array(9),t.skip(24),n.nextTrackId=t.readU32();break;case"trak":n.name="Track Box",o(),this.tracks[n.tkhd.trackId]=new i(this,n);break;case"tkhd":n.name="Track Header Box",r(),e(0==n.version),n.creationTime=t.readU32(),n.modificationTime=t.readU32(),n.trackId=t.readU32(),t.skip(4),n.duration=t.readU32(),t.skip(8),n.layer=t.readU16(),n.alternateGroup=t.readU16(),n.volume=t.readFP8(),t.skip(2),n.matrix=t.readU32Array(9),n.width=t.readFP16(),n.height=t.readFP16();break;case"mdia":n.name="Media Box",o();break;case"mdhd":n.name="Media Header Box",r(),e(0==n.version),n.creationTime=t.readU32(),n.modificationTime=t.readU32(),n.timeScale=t.readU32(),n.duration=t.readU32(),n.language=t.readISO639(),t.skip(2);break;case"hdlr":n.name="Handler Reference Box",r(),t.skip(4),n.handlerType=t.read4CC(),t.skip(12);var u=n.size-32;u>0&&(n.name=t.readUTF8(u));break;case"minf":n.name="Media Information Box",o();break;case"stbl":n.name="Sample Table Box",o();break;case"stsd":n.name="Sample Description Box",r(),n.sd=[];t.readU32();o();break;case"avc1":t.reserved(6,0),n.dataReferenceIndex=t.readU16(),e(0==t.readU16()),e(0==t.readU16()),t.readU32(),t.readU32(),t.readU32(),n.width=t.readU16(),n.height=t.readU16(),n.horizontalResolution=t.readFP16(),n.verticalResolution=t.readFP16(),e(0==t.readU32()),n.frameCount=t.readU16(),n.compressorName=t.readPString(32),n.depth=t.readU16(),e(65535==t.readU16()),o();break;case"mp4a":t.reserved(6,0),n.dataReferenceIndex=t.readU16(),n.version=t.readU16(),t.skip(2),t.skip(4),n.channelCount=t.readU16(),n.sampleSize=t.readU16(),n.compressionId=t.readU16(),n.packetSize=t.readU16(),n.sampleRate=t.readU32()>>>16,e(0==n.version),o();break;case"esds":n.name="Elementary Stream Descriptor",r(),a();break;case"avcC":n.name="AVC Configuration Box",n.configurationVersion=t.readU8(),n.avcProfileIndication=t.readU8(),n.profileCompatibility=t.readU8(),n.avcLevelIndication=t.readU8(),n.lengthSizeMinusOne=3&t.readU8(),e(3==n.lengthSizeMinusOne,"TODO");var l=31&t.readU8();n.sps=[];for(c=0;c<l;c++)n.sps.push(t.readU8Array(t.readU16()));l=31&t.readU8();n.pps=[];for(c=0;c<l;c++)n.pps.push(t.readU8Array(t.readU16()));a();break;case"btrt":n.name="Bit Rate Box",n.bufferSizeDb=t.readU32(),n.maxBitrate=t.readU32(),n.avgBitrate=t.readU32();break;case"stts":n.name="Decoding Time to Sample Box",r(),n.table=t.readU32Array(t.readU32(),2,["count","delta"]);break;case"stss":n.name="Sync Sample Box",r(),n.samples=t.readU32Array(t.readU32());break;case"stsc":n.name="Sample to Chunk Box",r(),n.table=t.readU32Array(t.readU32(),3,["firstChunk","samplesPerChunk","sampleDescriptionId"]);break;case"stsz":n.name="Sample Size Box",r(),n.sampleSize=t.readU32();l=t.readU32();0==n.sampleSize&&(n.table=t.readU32Array(l));break;case"stco":n.name="Chunk Offset Box",r(),n.table=t.readU32Array(t.readU32());break;case"smhd":n.name="Sound Media Header Box",r(),n.balance=t.readFP8(),t.reserved(2,0);break;case"mdat":n.name="Media Data Box",e(n.size>=8,"Cannot parse large media data yet."),n.data=t.readU8Array(s());break;default:a()}return n},read:function(){var e=(new Date).getTime();this.file={},this.readBoxes(this.stream,this.file),console.info("Parsed stream in "+((new Date).getTime()-e)+" ms")},traceSamples:function(){var e=this.tracks[1],t=this.tracks[2];console.info("Video Samples: "+e.getSampleCount()),console.info("Audio Samples: "+t.getSampleCount());for(var n=0,r=0,s=0;s<100;s++){var a=e.sampleToOffset(n),i=t.sampleToOffset(r),o=e.sampleToSize(n,1),c=t.sampleToSize(r,1);a<i?(console.info("V Sample "+n+" Offset : "+a+", Size : "+o),n++):(console.info("A Sample "+r+" Offset : "+i+", Size : "+c),r++)}}},t}(),i=function(){function t(e,t){this.file=e,this.trak=t}return t.prototype={getSampleSizeTable:function(){return this.trak.mdia.minf.stbl.stsz.table},getSampleCount:function(){return this.getSampleSizeTable().length},sampleToSize:function(e,t){for(var n=this.getSampleSizeTable(),r=0,s=e;s<e+t;s++)r+=n[s];return r},sampleToChunk:function(t){var n=this.trak.mdia.minf.stbl.stsc.table;if(1===n.length)return e(1===(a=n[0]).firstChunk),{index:Math.floor(t/a.samplesPerChunk),offset:t%a.samplesPerChunk};for(var r=0,s=0;s<n.length;s++){var a=n[s];if(s>0){var i=n[s-1],o=a.firstChunk-i.firstChunk,c=i.samplesPerChunk*o;if(!(t>=c))return{index:r+Math.floor(t/i.samplesPerChunk),offset:t%i.samplesPerChunk};if(t-=c,s==n.length-1)return{index:r+o+Math.floor(t/a.samplesPerChunk),offset:t%a.samplesPerChunk};r+=o}}e(!1)},chunkToOffset:function(e){return this.trak.mdia.minf.stbl.stco.table[e]},sampleToOffset:function(e){var t=this.sampleToChunk(e);return this.chunkToOffset(t.index)+this.sampleToSize(e-t.offset,t.offset)},timeToSample:function(e){for(var t=this.trak.mdia.minf.stbl.stts.table,n=0,r=0;r<t.length;r++){var s=t[r].count*t[r].delta;if(!(e>=s))return n+Math.floor(e/t[r].delta);e-=s,n+=t[r].count}},getTotalTime:function(){for(var t=this.trak.mdia.minf.stbl.stts.table,n=0,r=0;r<t.length;r++)n+=t[r].count*t[r].delta;return e(this.trak.mdia.mdhd.duration==n),this.trak.mdia.mdhd.duration},getTotalTimeInSeconds:function(){return this.timeToSeconds(this.getTotalTime())},getTimeScale:function(){return this.trak.mdia.mdhd.timeScale},timeToSeconds:function(e){return e/this.getTimeScale()},secondsToTime:function(e){return e*this.getTimeScale()},foo:function(){},getSampleNALUnits:function(e){for(var t=this.file.stream.bytes,n=this.sampleToOffset(e),r=n+this.sampleToSize(e,1),a=[];r-n>0;){var i=new s(t.buffer,n).readU32();a.push(t.subarray(n+4,n+i+4)),n=n+i+4}return a}},t}();t=[],n="zero-timeout-message",window.addEventListener("message",(function(e){e.source==window&&e.data==n&&(e.stopPropagation(),t.length>0&&t.shift()())}),!0),window.setZeroTimeout=function(e){t.push(e),window.postMessage(n,"*")};var o=function(){function e(e,n,r,s){this.stream=e,this.useWorkers=n,this.webgl=r,this.render=s,this.statistics={videoStartTime:0,videoPictureCounter:0,windowStartTime:0,windowPictureCounter:0,fps:0,fpsMin:1e3,fpsMax:-1e3,webGLTextureUploadTime:0},this.onStatisticsUpdated=function(){},this.avc=new Player({useWorker:n,reuseMemory:!0,webgl:r,size:{width:640,height:368}}),this.webgl=this.avc.webgl;var a=this;this.avc.onPictureDecoded=function(){t.call(a)},this.canvas=this.avc.canvas}function t(){var e=this.statistics;e.videoPictureCounter+=1,e.windowPictureCounter+=1;var t=Date.now();e.videoStartTime||(e.videoStartTime=t);var n=t-e.videoStartTime;if(e.elapsed=n/1e3,!(n<1e3))if(e.windowStartTime){if(t-e.windowStartTime>1e3){var r=t-e.windowStartTime,s=e.windowPictureCounter/r*1e3;e.windowStartTime=t,e.windowPictureCounter=0,s<e.fpsMin&&(e.fpsMin=s),s>e.fpsMax&&(e.fpsMax=s),e.fps=s}s=e.videoPictureCounter/n*1e3;e.fpsSinceStart=s,this.onStatisticsUpdated(this.statistics)}else e.windowStartTime=t}return e.prototype={readAll:function(e){console.info("MP4Player::readAll()"),this.stream.readAll(null,function(t){this.reader=new a(new s(t)),this.reader.read();var n=this.reader.tracks[1];this.size=new r(n.trak.tkhd.width,n.trak.tkhd.height),console.info("MP4Player::readAll(), length: "+this.reader.stream.length),e&&e()}.bind(this))},play:function(){var e=this.reader;if(e){var t=e.tracks[1],n=(e.tracks[2],e.tracks[1].trak.mdia.minf.stbl.stsd.avc1.avcC),r=n.sps[0],s=n.pps[0];this.avc.decode(r),this.avc.decode(s);var a=0;setTimeout(function e(){var n=this.avc;t.getSampleNALUnits(a).forEach((function(e){n.decode(e)})),++a<3e3&&setTimeout(e.bind(this),1)}.bind(this),1)}else this.readAll(this.play.bind(this))}},e}(),c=function(){function e(e){var t=e.attributes.src?e.attributes.src.value:void 0,n=(e.attributes.width&&e.attributes.width.value,e.attributes.height&&e.attributes.height.value,document.createElement("div"));n.setAttribute("style","z-index: 100; position: absolute; bottom: 0px; background-color: rgba(0,0,0,0.8); height: 30px; width: 100%; text-align: left;"),this.info=document.createElement("div"),this.info.setAttribute("style","font-size: 14px; font-weight: bold; padding: 6px; color: lime;"),n.appendChild(this.info),e.appendChild(n);var r=!!e.attributes.workers&&"true"==e.attributes.workers.value,s=!!e.attributes.render&&"true"==e.attributes.render.value,a="auto";e.attributes.webgl&&("true"==e.attributes.webgl.value&&(a=!0),"false"==e.attributes.webgl.value&&(a=!1));var i="";i+=r?"worker thread ":"main thread ",this.player=new o(new Stream(t),r,a,s),this.canvas=this.player.canvas,this.canvas.onclick=function(){this.play()}.bind(this),e.appendChild(this.canvas),i+=" - webgl: "+this.player.webgl,this.info.innerHTML="Click canvas to load and play - "+i,this.score=null,this.player.onStatisticsUpdated=function(e){if(e.videoPictureCounter%10==0){var t="";e.fps&&(t+=" fps: "+e.fps.toFixed(2)),e.fpsSinceStart&&(t+=" avg: "+e.fpsSinceStart.toFixed(2));e.videoPictureCounter<1200?this.score=1200-e.videoPictureCounter:1200==e.videoPictureCounter&&(this.score=e.fpsSinceStart.toFixed(2)),this.info.innerHTML=i+t}}.bind(this)}return e.prototype={play:function(){this.player.play()}},e}();return{Size:r,Track:i,MP4Reader:a,MP4Player:o,Bytestream:s,Broadway:c}}()},function(e,t,n){"use strict";(function(e){Object.defineProperty(t,"__esModule",{value:!0});var n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},r="undefined"!=typeof window&&void 0!==window.document,s="object"===("undefined"==typeof self?"undefined":n(self))&&self.constructor&&"DedicatedWorkerGlobalScope"===self.constructor.name,a=void 0!==e&&null!=e.versions&&null!=e.versions.node;t.isBrowser=r,t.isWebWorker=s,t.isNode=a}).call(this,n(15))},function(e,t,n){(()=>{const t=n(2),r=n(64),s=n(66),{checkObjectType:a}=n(8),{Task:i}=n(6),{Loader:o,Dumper:c}=n(21),{ScriptingError:u,DataError:l,ArgumentError:h}=n(0),p=new WeakMap,d=new WeakMap;function f(e){if("task"===e)return d;if("job"===e)return p;throw new u("Unknown session type was received ".concat(e))}async function b(e){const n=e instanceof i?"task":"job",a=f(n);if(!a.has(e)){const i=await t.annotations.getAnnotations(n,e.id),o="job"===n?e.startFrame:0,c="job"===n?e.stopFrame:e.size-1,u={};for(let t=o;t<=c;t++)u[t]=await e.frames.get(t);const l=new r({labels:e.labels||e.task.labels,startFrame:o,stopFrame:c,frameMeta:u}).import(i),h=new s(i.version,l,e);a.set(e,{collection:l,saver:h})}}e.exports={getAnnotations:async function(e,t,n){return await b(e),f(e instanceof i?"task":"job").get(e).collection.get(t,n)},putAnnotations:function(e,t){const n=f(e instanceof i?"task":"job");if(n.has(e))return n.get(e).collection.put(t);throw new l("Collection has not been initialized yet. Call annotations.get() or annotations.clear(true) before")},saveAnnotations:async function(e,t){const n=f(e instanceof i?"task":"job");n.has(e)&&await n.get(e).saver.save(t)},hasUnsavedChanges:function(e){const t=f(e instanceof i?"task":"job");return!!t.has(e)&&t.get(e).saver.hasUnsavedChanges()},mergeAnnotations:function(e,t){const n=f(e instanceof i?"task":"job");if(n.has(e))return n.get(e).collection.merge(t);throw new l("Collection has not been initialized yet. Call annotations.get() or annotations.clear(true) before")},splitAnnotations:function(e,t,n){const r=f(e instanceof i?"task":"job");if(r.has(e))return r.get(e).collection.split(t,n);throw new l("Collection has not been initialized yet. Call annotations.get() or annotations.clear(true) before")},groupAnnotations:function(e,t,n){const r=f(e instanceof i?"task":"job");if(r.has(e))return r.get(e).collection.group(t,n);throw new l("Collection has not been initialized yet. Call annotations.get() or annotations.clear(true) before")},clearAnnotations:async function(e,t){a("reload",t,"boolean",null);const n=f(e instanceof i?"task":"job");n.has(e)&&n.get(e).collection.clear(),t&&(n.delete(e),await b(e))},annotationsStatistics:function(e){const t=f(e instanceof i?"task":"job");if(t.has(e))return t.get(e).collection.statistics();throw new l("Collection has not been initialized yet. Call annotations.get() or annotations.clear(true) before")},selectObject:function(e,t,n,r){const s=f(e instanceof i?"task":"job");if(s.has(e))return s.get(e).collection.select(t,n,r);throw new l("Collection has not been initialized yet. Call annotations.get() or annotations.clear(true) before")},uploadAnnotations:async function(e,n,r){const s=e instanceof i?"task":"job";if(!(r instanceof o))throw new h("A loader must be instance of Loader class");await t.annotations.uploadAnnotations(s,e.id,n,r.name)},dumpAnnotations:async function(e,n,r){if(!(r instanceof c))throw new h("A dumper must be instance of Dumper class");let s=null;return s="job"===(e instanceof i?"task":"job")?await t.annotations.dumpAnnotations(e.task.id,n,r.name):await t.annotations.dumpAnnotations(e.id,n,r.name)},exportDataset:async function(e,n){if(!(n instanceof String||"string"==typeof n))throw new h("Format must be a string");if(!(e instanceof i))throw new h("A dataset can only be created from a task");let r=null;return r=await t.tasks.exportDataset(e.id,n)}}})()},function(e,t,n){(()=>{const{RectangleShape:t,PolygonShape:r,PolylineShape:s,PointsShape:a,RectangleTrack:i,PolygonTrack:o,PolylineTrack:c,PointsTrack:u,Track:l,Shape:h,Tag:p,objectStateFactory:d}=n(65),{checkObjectType:f}=n(8),b=n(20),{Label:m}=n(7),{DataError:g,ArgumentError:y,ScriptingError:v}=n(0),{ObjectShape:w,ObjectType:k,colors:O}=n(4),x=n(13);function _(e,n,i){const{type:o}=e,c=O[n%O.length];let u=null;switch(o){case"rectangle":u=new t(e,n,c,i);break;case"polygon":u=new r(e,n,c,i);break;case"polyline":u=new s(e,n,c,i);break;case"points":u=new a(e,n,c,i);break;default:throw new g('An unexpected type of shape "'.concat(o,'"'))}return u}function j(e,t,n){if(e.shapes.length){const{type:r}=e.shapes[0],s=O[t%O.length];let a=null;switch(r){case"rectangle":a=new i(e,t,s,n);break;case"polygon":a=new o(e,t,s,n);break;case"polyline":a=new c(e,t,s,n);break;case"points":a=new u(e,t,s,n);break;default:throw new g('An unexpected type of track "'.concat(r,'"'))}return a}return console.warn("The track without any shapes had been found. It was ignored."),null}e.exports=class{constructor(e){this.startFrame=e.startFrame,this.stopFrame=e.stopFrame,this.frameMeta=e.frameMeta,this.labels=e.labels.reduce((e,t)=>(e[t.id]=t,e),{}),this.shapes={},this.tags={},this.tracks=[],this.objects={},this.count=0,this.flush=!1,this.collectionZ={},this.groups={max:0},this.injection={labels:this.labels,collectionZ:this.collectionZ,groups:this.groups,frameMeta:this.frameMeta}}import(e){for(const t of e.tags){const e=++this.count,n=new p(t,e,this.injection);this.tags[n.frame]=this.tags[n.frame]||[],this.tags[n.frame].push(n),this.objects[e]=n}for(const t of e.shapes){const e=++this.count,n=_(t,e,this.injection);this.shapes[n.frame]=this.shapes[n.frame]||[],this.shapes[n.frame].push(n),this.objects[e]=n}for(const t of e.tracks){const e=++this.count,n=j(t,e,this.injection);n&&(this.tracks.push(n),this.objects[e]=n)}return this}export(){return{tracks:this.tracks.filter(e=>!e.removed).map(e=>e.toJSON()),shapes:Object.values(this.shapes).reduce((e,t)=>(e.push(...t),e),[]).filter(e=>!e.removed).map(e=>e.toJSON()),tags:Object.values(this.tags).reduce((e,t)=>(e.push(...t),e),[]).filter(e=>!e.removed).map(e=>e.toJSON())}}get(e){const{tracks:t}=this,n=this.shapes[e]||[],r=this.tags[e]||[],s=t.concat(n).concat(r).filter(e=>!e.removed),a=[];for(const t of s){const n=t.get(e);if(n.outside&&!n.keyframe)continue;const r=d.call(t,e,n);a.push(r)}return a}merge(e){if(f("shapes for merge",e,null,Array),!e.length)return;const t=e.map(e=>{f("object state",e,null,x);const t=this.objects[e.clientID];if(void 0===t)throw new y("The object has not been saved yet. Call ObjectState.put([state]) before you can merge it");return t}),n={},{label:r,shapeType:s}=e[0];if(!(r.id in this.labels))throw new y("Unknown label for the task: ".concat(r.id));if(!Object.values(w).includes(s))throw new y('Got unknown shapeType "'.concat(s,'"'));const a=r.attributes.reduce((e,t)=>(e[t.id]=t,e),{});for(let i=0;i<t.length;i++){const o=t[i],c=e[i];if(c.label.id!==r.id)throw new y("All shape labels are expected to be ".concat(r.name,", but got ").concat(c.label.name));if(c.shapeType!==s)throw new y("All shapes are expected to be ".concat(s,", but got ").concat(c.shapeType));if(o instanceof h){if(o.frame in n&&!n[o.frame].outside)throw new y("Expected only one visible shape per frame");n[o.frame]={type:s,frame:o.frame,points:[...o.points],occluded:o.occluded,zOrder:o.zOrder,outside:!1,attributes:Object.keys(o.attributes).reduce((e,t)=>(t in a&&a[t].mutable&&e.push({spec_id:+t,value:o.attributes[t]}),e),[])},o.frame+1 in n||(n[o.frame+1]=JSON.parse(JSON.stringify(n[o.frame])),n[o.frame+1].outside=!0,n[o.frame+1].frame++)}else{if(!(o instanceof l))throw new y("Trying to merge unknown object type: ".concat(o.constructor.name,". ")+"Only shapes and tracks are expected.");{const e={};for(const t of Object.keys(o.shapes)){const r=o.shapes[t];if(t in n&&!n[t].outside){if(r.outside)continue;throw new y("Expected only one visible shape per frame")}let a=!1;for(const t in r.attributes)t in e&&e[t]===r.attributes[t]||(a=!0,e[t]=r.attributes[t]);n[t]={type:s,frame:+t,points:[...r.points],occluded:r.occluded,outside:r.outside,zOrder:r.zOrder,attributes:a?Object.keys(e).reduce((t,n)=>(t.push({spec_id:+n,value:e[n]}),t),[]):[]}}}}}let i=!1;for(const e of Object.keys(n).sort((e,t)=>+e-+t)){if((i=i||n[e].outside)||!n[e].outside)break;delete n[e]}const o=++this.count,c=j({frame:Math.min.apply(null,Object.keys(n).map(e=>+e)),shapes:Object.values(n),group:0,label_id:r.id,attributes:Object.keys(e[0].attributes).reduce((t,n)=>(a[n].mutable||t.push({spec_id:+n,value:e[0].attributes[n]}),t),[])},o,this.injection);this.tracks.push(c),this.objects[o]=c;for(const e of t)e.removed=!0}split(e,t){f("object state",e,null,x),f("frame",t,"integer",null);const n=this.objects[e.clientID];if(void 0===n)throw new y("The object has not been saved yet. Call annotations.put([state]) before");if(e.objectType!==k.TRACK)return;const r=Object.keys(n.shapes).sort((e,t)=>+e-+t);if(t<=+r[0])return;const s=n.label.attributes.reduce((e,t)=>(e[t.id]=t,e),{}),a=n.toJSON(),i={type:e.shapeType,points:[...e.points],occluded:e.occluded,outside:e.outside,zOrder:0,attributes:Object.keys(e.attributes).reduce((t,n)=>(s[n].mutable||t.push({spec_id:+n,value:e.attributes[n]}),t),[]),frame:t},o={frame:a.frame,group:0,label_id:a.label_id,attributes:a.attributes,shapes:[]},c=JSON.parse(JSON.stringify(o));c.frame=t,c.shapes.push(JSON.parse(JSON.stringify(i))),a.shapes.map(e=>(delete e.id,e.frame<t?o.shapes.push(JSON.parse(JSON.stringify(e))):e.frame>t&&c.shapes.push(JSON.parse(JSON.stringify(e))),e)),o.shapes.push(i),o.shapes[o.shapes.length-1].outside=!0;let u=++this.count;const l=j(o,u,this.injection);this.tracks.push(l),this.objects[u]=l,u=++this.count;const h=j(c,u,this.injection);this.tracks.push(h),this.objects[u]=h,n.removed=!0}group(e,t){f("shapes for group",e,null,Array);const n=e.map(e=>{f("object state",e,null,x);const t=this.objects[e.clientID];if(void 0===t)throw new y("The object has not been saved yet. Call annotations.put([state]) before");return t}),r=t?0:++this.groups.max;for(const e of n)e.group=r;return r}clear(){this.shapes={},this.tags={},this.tracks=[],this.objects={},this.count=0,this.flush=!0}statistics(){const e={},t={rectangle:{shape:0,track:0},polygon:{shape:0,track:0},polyline:{shape:0,track:0},points:{shape:0,track:0},tags:0,manually:0,interpolated:0,total:0},n=JSON.parse(JSON.stringify(t));for(const n of Object.values(this.labels)){const{name:r}=n;e[r]=JSON.parse(JSON.stringify(t))}for(const t of Object.values(this.objects)){if(t.removed)continue;let n=null;if(t instanceof h)n="shape";else if(t instanceof l)n="track";else{if(!(t instanceof p))throw new v('Unexpected object type: "'.concat(n,'"'));n="tag"}const r=t.label.name;if("tag"===n)e[r].tags++,e[r].manually++,e[r].total++;else{const{shapeType:s}=t;if(e[r][s][n]++,"track"===n){const n=Object.keys(t.shapes).sort((e,t)=>+e-+t).map(e=>+e);let s=n[0],a=!1;for(const i of n){if(a){const t=i-s-1;e[r].interpolated+=t,e[r].total+=t}a=!t.shapes[i].outside,s=i,a&&(e[r].manually++,e[r].total++)}const i=n[n.length-1];if(i!==this.stopFrame&&!t.shapes[i].outside){const t=this.stopFrame-i;e[r].interpolated+=t,e[r].total+=t}}else e[r].manually++,e[r].total++}}for(const t of Object.keys(e))for(const r of Object.keys(e[t]))if("object"==typeof e[t][r])for(const s of Object.keys(e[t][r]))n[r][s]+=e[t][r][s];else n[r]+=e[t][r];return new b(e,n)}put(e){f("shapes for put",e,null,Array);const t={shapes:[],tracks:[],tags:[]};function n(e,t){const n=+t,r=this.attributes[t];return f("attribute id",n,"integer",null),f("attribute value",r,"string",null),e.push({spec_id:n,value:r}),e}for(const r of e){f("object state",r,null,x),f("state client ID",r.clientID,"undefined",null),f("state frame",r.frame,"integer",null),f("state attributes",r.attributes,null,Object),f("state label",r.label,null,m);const e=Object.keys(r.attributes).reduce(n.bind(r),[]),s=r.label.attributes.reduce((e,t)=>(e[t.id]=t,e),{});if("tag"===r.objectType)t.tags.push({attributes:e,frame:r.frame,label_id:r.label.id,group:0});else{f("state occluded",r.occluded,"boolean",null),f("state points",r.points,null,Array);for(const e of r.points)f("point coordinate",e,"number",null);if(!Object.values(w).includes(r.shapeType))throw new y("Object shape must be one of: "+"".concat(JSON.stringify(Object.values(w))));if("shape"===r.objectType)t.shapes.push({attributes:e,frame:r.frame,group:0,label_id:r.label.id,occluded:r.occluded||!1,points:[...r.points],type:r.shapeType,z_order:0});else{if("track"!==r.objectType)throw new y("Object type must be one of: "+"".concat(JSON.stringify(Object.values(k))));t.tracks.push({attributes:e.filter(e=>!s[e.spec_id].mutable),frame:r.frame,group:0,label_id:r.label.id,shapes:[{attributes:e.filter(e=>s[e.spec_id].mutable),frame:r.frame,occluded:r.occluded||!1,outside:!1,points:[...r.points],type:r.shapeType,z_order:0}]})}}}this.import(t)}select(e,t,n){f("shapes for select",e,null,Array),f("x coordinate",t,"number",null),f("y coordinate",n,"number",null);let r=null,s=null;for(const a of e){if(f("object state",a,null,x),a.outside||a.hidden)continue;const e=this.objects[a.clientID];if(void 0===e)throw new y("The object has not been saved yet. Call annotations.put([state]) before");const i=e.constructor.distance(a.points,t,n);null!==i&&(null===r||i<r)&&(r=i,s=a)}return{state:s,distance:r}}}})()},function(e,t,n){(()=>{const t=n(13),{checkObjectType:r}=n(8),{colors:s,ObjectShape:a,ObjectType:i,AttributeType:o}=n(4),{DataError:c,ArgumentError:u,ScriptingError:l}=n(0),{Label:h}=n(7),p="#E0E0E0";function d(e,n){const r=new t(n);return r.__internal={save:this.save.bind(this,e,r),delete:this.delete.bind(this),up:this.up.bind(this,e,r),down:this.down.bind(this,e,r)},r}function f(e,t){if(e===a.RECTANGLE){if(t.length/2!=2)throw new c("Rectangle must have 2 points, but got ".concat(t.length/2))}else if(e===a.POLYGON){if(t.length/2<3)throw new c("Polygon must have at least 3 points, but got ".concat(t.length/2))}else if(e===a.POLYLINE){if(t.length/2<2)throw new c("Polyline must have at least 2 points, but got ".concat(t.length/2))}else{if(e!==a.POINTS)throw new u("Unknown value of shapeType has been recieved ".concat(e));if(t.length/2<1)throw new c("Points must have at least 1 points, but got ".concat(t.length/2))}}function b(e,t){const{values:n}=t,r=t.inputType;if("string"!=typeof e)throw new u("Attribute value is expected to be string, but got ".concat(typeof e));return r===o.NUMBER?+e>=+n[0]&&+e<=+n[1]&&!((+e-+n[0])%+n[2]):r===o.CHECKBOX?["true","false"].includes(e.toLowerCase()):r===o.TEXT||n.includes(e)}class m{constructor(e,t,n){this.taskLabels=n.labels,this.clientID=t,this.serverID=e.id,this.group=e.group,this.label=this.taskLabels[e.label_id],this.frame=e.frame,this.removed=!1,this.lock=!1,this.updated=Date.now(),this.attributes=e.attributes.reduce((e,t)=>(e[t.spec_id]=t.value,e),{}),this.appendDefaultAttributes(this.label),n.groups.max=Math.max(n.groups.max,this.group)}appendDefaultAttributes(e){const t=e.attributes;for(const e of t)e.id in this.attributes||(this.attributes[e.id]=e.defaultValue)}updateTimestamp(e){(e.label||e.attributes||e.points||e.outside||e.occluded||e.keyframe||e.zOrder)&&(this.updated=Date.now())}delete(e){return this.lock&&!e||(this.removed=!0),!0}}class g extends m{constructor(e,t,n,r){super(e,t,r),this.frameMeta=r.frameMeta,this.collectionZ=r.collectionZ,this.hidden=!1,this.color=n,this.shapeType=null}_getZ(e){return this.collectionZ[e]=this.collectionZ[e]||{max:0,min:0},this.collectionZ[e]}validateStateBeforeSave(e,t){let n=[];const s=t.updateFlags;s.label&&r("label",t.label,null,h);const i=t.label.attributes.reduce((e,t)=>(e[t.id]=t,e),{});if(s.attributes)for(const e of Object.keys(t.attributes)){const n=t.attributes[e];if(!(e in i))throw new u("The label of the shape doesn't have the attribute with id ".concat(e," and value ").concat(n));if(!b(n,i[e]))throw new u("Trying to save an attribute attribute with id ".concat(e," and invalid value ").concat(n))}if(s.points){r("points",t.points,null,Array),f(this.shapeType,t.points);const{width:s,height:i}=this.frameMeta[e];for(let e=0;e<t.points.length-1;e+=2){const a=t.points[e],o=t.points[e+1];r("coordinate",a,"number",null),r("coordinate",o,"number",null),n.push(Math.clamp(a,0,s),Math.clamp(o,0,i))}(function(e,t){if(e===a.POINTS)return!0;let n=Number.MAX_SAFE_INTEGER,r=Number.MIN_SAFE_INTEGER,s=Number.MAX_SAFE_INTEGER,i=Number.MIN_SAFE_INTEGER;for(let e=0;e<t.length-1;e+=2)n=Math.min(n,t[e]),r=Math.max(r,t[e]),s=Math.min(s,t[e+1]),i=Math.max(i,t[e+1]);if(e===a.POLYLINE){return Math.max(r-n,i-s)>=3}return(r-n)*(i-s)>=9})(this.shapeType,n)||(n=!1)}if(s.occluded&&r("occluded",t.occluded,"boolean",null),s.outside&&r("outside",t.outside,"boolean",null),s.zOrder&&r("zOrder",t.zOrder,"integer",null),s.lock&&r("lock",t.lock,"boolean",null),s.color&&(r("color",t.color,"string",null),/^#[0-9A-F]{6}$/i.test(t.color)))throw new u('Got invalid color value: "'.concat(t.color,'"'));return s.hidden&&r("hidden",t.hidden,"boolean",null),s.keyframe&&r("keyframe",t.keyframe,"boolean",null),n}save(){throw new l("Is not implemented")}get(){throw new l("Is not implemented")}toJSON(){throw new l("Is not implemented")}up(e,t){const n=this._getZ(e);n.max++,t.zOrder=n.max}down(e,t){const n=this._getZ(e);n.min--,t.zOrder=n.min}}class y extends g{constructor(e,t,n,r){super(e,t,n,r),this.points=e.points,this.occluded=e.occluded,this.zOrder=e.z_order;const s=this._getZ(this.frame);s.max=Math.max(s.max,this.zOrder||0),s.min=Math.min(s.min,this.zOrder||0)}toJSON(){return{type:this.shapeType,clientID:this.clientID,occluded:this.occluded,z_order:this.zOrder,points:[...this.points],attributes:Object.keys(this.attributes).reduce((e,t)=>(e.push({spec_id:t,value:this.attributes[t]}),e),[]),id:this.serverID,frame:this.frame,label_id:this.label.id,group:this.group}}get(e){if(e!==this.frame)throw new l("Got frame is not equal to the frame of the shape");return{objectType:i.SHAPE,shapeType:this.shapeType,clientID:this.clientID,serverID:this.serverID,occluded:this.occluded,lock:this.lock,zOrder:this.zOrder,points:[...this.points],attributes:{...this.attributes},label:this.label,group:{color:this.group?s[this.group%s.length]:p,id:this.group},color:this.color,hidden:this.hidden,updated:this.updated,frame:e}}save(e,t){if(e!==this.frame)throw new l("Got frame is not equal to the frame of the shape");if(this.lock&&t.lock)return d.call(this,e,this.get(e));const n=this.validateStateBeforeSave(e,t),r=t.updateFlags;if(r.label&&(this.label=t.label,this.attributes={},this.appendDefaultAttributes(t.label)),r.attributes)for(const e of Object.keys(t.attributes))this.attributes[e]=t.attributes[e];return r.points&&n.length&&(this.points=[...n]),r.occluded&&(this.occluded=t.occluded),r.zOrder&&(this.zOrder=t.zOrder),r.lock&&(this.lock=t.lock),r.color&&(this.color=t.color),r.hidden&&(this.hidden=t.hidden),this.updateTimestamp(r),r.reset(),d.call(this,e,this.get(e))}}class v extends g{constructor(e,t,n,r){super(e,t,n,r),this.shapes=e.shapes.reduce((e,t)=>{e[t.frame]={serverID:t.id,occluded:t.occluded,zOrder:t.z_order,points:t.points,outside:t.outside,attributes:t.attributes.reduce((e,t)=>(e[t.spec_id]=t.value,e),{})};const n=this._getZ(t.frame);return n.max=Math.max(n.max,t.z_order),n.min=Math.min(n.min,t.z_order),e},{})}toJSON(){const e=this.label.attributes.reduce((e,t)=>(e[t.id]=t,e),{});return{clientID:this.clientID,id:this.serverID,frame:this.frame,label_id:this.label.id,group:this.group,attributes:Object.keys(this.attributes).reduce((t,n)=>(e[n].mutable||t.push({spec_id:n,value:this.attributes[n]}),t),[]),shapes:Object.keys(this.shapes).reduce((t,n)=>(t.push({type:this.shapeType,occluded:this.shapes[n].occluded,z_order:this.shapes[n].zOrder,points:[...this.shapes[n].points],outside:this.shapes[n].outside,attributes:Object.keys(this.shapes[n].attributes).reduce((t,r)=>(e[r].mutable&&t.push({spec_id:r,value:this.shapes[n].attributes[r]}),t),[]),id:this.shapes[n].serverID,frame:+n}),t),[])}}get(e){const{prev:t,next:n,first:r,last:a}=this.boundedKeyframes(e);return{...this.getPosition(e,t,n),attributes:this.getAttributes(e),group:{color:this.group?s[this.group%s.length]:p,id:this.group},objectType:i.TRACK,shapeType:this.shapeType,clientID:this.clientID,serverID:this.serverID,lock:this.lock,color:this.color,hidden:this.hidden,updated:this.updated,label:this.label,keyframes:{prev:t,next:n,first:r,last:a},frame:e}}boundedKeyframes(e){const t=Object.keys(this.shapes).map(e=>+e);let n=Number.MAX_SAFE_INTEGER,r=Number.MAX_SAFE_INTEGER,s=Number.MAX_SAFE_INTEGER,a=Number.MIN_SAFE_INTEGER;for(const i of t){i<s&&(s=i),i>a&&(a=i);const t=Math.abs(e-i);i<e&&t<n?n=t:i>e&&t<r&&(r=t)}return{prev:n===Number.MAX_SAFE_INTEGER?null:e-n,next:r===Number.MAX_SAFE_INTEGER?null:e+r,first:s,last:a}}getAttributes(e){const t={};for(const e in this.attributes)Object.prototype.hasOwnProperty.call(this.attributes,e)&&(t[e]=this.attributes[e]);const n=Object.keys(this.shapes).sort((e,t)=>+e-+t);for(const r of n)if(r<=e){const{attributes:e}=this.shapes[r];for(const n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])}return t}save(e,t){if(this.lock&&t.lock)return d.call(this,e,this.get(e));const n=this.validateStateBeforeSave(e,t),r=t.updateFlags,s=this.get(e),a=t.label.attributes.reduce((e,t)=>(e[t.id]=t,e),{});if(r.label){this.label=t.label,this.attributes={};for(const e of Object.values(this.shapes))e.attributes={};this.appendDefaultAttributes(t.label)}let i=!1;if(r.attributes)for(const n of Object.keys(t.attributes))a[n].mutable?t.attributes[n]!==s.attributes[n]&&(i=i||!(e in this.shapes)||!(n in this.shapes[e])||this.shapes[e][n]!==t.attributes[n]):(this.attributes[n]=t.attributes[n],this.attributes[n]=t.attributes[n]);if(r.lock&&(this.lock=t.lock),r.color&&(this.color=t.color),r.hidden&&(this.hidden=t.hidden),r.points||r.keyframe||r.outside||r.occluded||r.zOrder||i){const i=e in this.shapes?this.shapes[e].attributes:{};this.shapes[e]={frame:e,zOrder:t.zOrder,points:r.points&&n.length?n:s.points,outside:t.outside,occluded:t.occluded,attributes:i};for(const n of Object.keys(t.attributes))a[n].mutable&&t.attributes[n]!==s.attributes[n]&&(this.shapes[e].attributes[n]=t.attributes[n],this.shapes[e].attributes[n]=t.attributes[n]);if(r.keyframe&&!t.keyframe){if(1===Object.keys(this.shapes).length)throw new c("You are not able to remove the latest keyframe for a track. Consider removing a track instead");delete this.shapes[e]}}return this.updateTimestamp(r),r.reset(),d.call(this,e,this.get(e))}getPosition(e,t,n){const r=e in this.shapes?e:t,s=Number.isInteger(n)?this.shapes[n]:null,a=Number.isInteger(r)?this.shapes[r]:null;if(a&&s)return{...this.interpolatePosition(a,s,(e-r)/(n-r)),keyframe:e in this.shapes};if(a)return{points:[...a.points],occluded:a.occluded,outside:a.outside,zOrder:0,keyframe:e in this.shapes};if(s)return{points:[...s.points],occluded:s.occluded,outside:!0,zOrder:0,keyframe:e in this.shapes};throw new c("No one left position or right position was found. "+"Interpolation impossible. Client ID: ".concat(this.id))}delete(e){return this.lock&&!e||(this.removed=!0),this.removed}}class w extends y{constructor(e,t,n,r){super(e,t,n,r),this.shapeType=a.RECTANGLE,f(this.shapeType,this.points)}static distance(e,t,n){const[r,s,a,i]=e;return t>=r&&t<=a&&n>=s&&n<=i?Math.min.apply(null,[t-r,n-s,a-t,i-n]):null}}class k extends y{constructor(e,t,n,r){super(e,t,n,r)}}class O extends k{constructor(e,t,n,r){super(e,t,n,r),this.shapeType=a.POLYGON,f(this.shapeType,this.points)}static distance(e,t,n){function r(e,r,s,a){return(s-e)*(n-r)-(t-e)*(a-r)}let s=0;const a=[];for(let i=0,o=e.length-2;i<e.length-1;o=i,i+=2){const c=e[o],u=e[o+1],l=e[i],h=e[i+1];u<=n?h>n&&r(c,u,l,h)>0&&s++:h<=n&&r(c,u,l,h)<0&&s--;const p=t-(u-h),d=n-(l-c);(p-c)*(l-p)>=0&&(d-u)*(h-d)>=0?a.push(Math.sqrt(Math.pow(t-p,2)+Math.pow(n-d,2))):a.push(Math.min(Math.sqrt(Math.pow(c-t,2)+Math.pow(u-n,2)),Math.sqrt(Math.pow(l-t,2)+Math.pow(h-n,2))))}return 0!==s?Math.min.apply(null,a):null}}class x extends k{constructor(e,t,n,r){super(e,t,n,r),this.shapeType=a.POLYLINE,f(this.shapeType,this.points)}static distance(e,t,n){const r=[];for(let s=0;s<e.length-2;s+=2){const a=e[s],i=e[s+1],o=e[s+2],c=e[s+3];(t-a)*(o-t)>=0&&(n-i)*(c-n)>=0?r.push(Math.abs((c-i)*t-(o-a)*n+o*i-c*a)/Math.sqrt(Math.pow(c-i,2)+Math.pow(o-a,2))):r.push(Math.min(Math.sqrt(Math.pow(a-t,2)+Math.pow(i-n,2)),Math.sqrt(Math.pow(o-t,2)+Math.pow(c-n,2))))}return Math.min.apply(null,r)}}class _ extends k{constructor(e,t,n,r){super(e,t,n,r),this.shapeType=a.POINTS,f(this.shapeType,this.points)}static distance(e,t,n){const r=[];for(let s=0;s<e.length;s+=2){const a=e[s],i=e[s+1];r.push(Math.sqrt(Math.pow(a-t,2)+Math.pow(i-n,2)))}return Math.min.apply(null,r)}}class j extends v{constructor(e,t,n,r){super(e,t,n,r),this.shapeType=a.RECTANGLE;for(const e of Object.values(this.shapes))f(this.shapeType,e.points)}interpolatePosition(e,t,n){const r=[t.points[0]-e.points[0],t.points[1]-e.points[1],t.points[2]-e.points[2],t.points[3]-e.points[3]];return{points:[e.points[0]+r[0]*n,e.points[1]+r[1]*n,e.points[2]+r[2]*n,e.points[3]+r[3]*n],occluded:e.occluded,outside:e.outside,zOrder:e.zOrder}}}class S extends v{constructor(e,t,n,r){super(e,t,n,r)}interpolatePosition(e,t,n){function r(e){let t=Number.MAX_SAFE_INTEGER,n=Number.MAX_SAFE_INTEGER,r=Number.MIN_SAFE_INTEGER,s=Number.MIN_SAFE_INTEGER;for(let a=0;a<e.length;a+=2)e[a]<t&&(t=e[a]),e[a+1]<n&&(n=e[a+1]),e[a]>r&&(r=e[a]),e[a+1]>s&&(s=e[a+1]);return{xmin:t,ymin:n,xmax:r,ymax:s}}function s(e,t){const n=[],r=t.xmax-t.xmin,s=t.ymax-t.ymin;for(let a=0;a<e.length;a+=2)n.push((e[a]-t.xmin)/r,(e[a+1]-t.ymin)/s);return n}function a(e,t){const n=[],r=t.xmax-t.xmin,s=t.ymax-t.ymin;for(let a=0;a<e.length;a+=2)n.push(e[a]*r+t.xmin,e[a+1]*s+t.ymin);return n}function i(e){const t=[];for(let n=0;n<e.length;n+=2)t.push({x:e[n],y:e[n+1]});return t}function o(e){const t=[];for(const n of e)t.push(n.x,n.y);return t}function c(e,t){function n(e){let t=0;for(let n=1;n<e.length;n+=2){t+=Math.sqrt(Math.pow(e[n].x-e[n-1].x,2)+Math.pow(e[n].y-e[n-1].y,2))}return t||Number.MAX_SAFE_INTEGER}function r(e,t){let n=0;for(let r=1;r<e.length;r+=2){const s=Math.sqrt(Math.pow(e[r].x-e[r-1].x,2)+Math.pow(e[r].y-e[r-1].y,2));n+=Math.pow(s-t,2)}return n}const s=[],a=[],i=function(e,t){const n={};for(let r=0;r<e.length;r++){n[r]=n[r]||{};for(let s=0;s<t.length;s++){const a=e[r].x-t[s].x,i=e[r].y-t[s].y;n[r][s]=Math.sqrt(Math.pow(a,2)+Math.pow(i,2))}}return n}(e,t),o=function(e,t,n){const r={};for(const s of e)r[s]=t.concat().sort((e,t)=>n[s][e]-n[s][t]);const s={},a={};let i=0;for(;Object.values(a).length!==e.length;){for(const t of e){if(a[t])continue;const e=r[t][i],o=n[t][e];if(e in s&&s[e].distance>o){const t=s[e].value;delete s[e],delete a[t]}e in s||(s[e]={value:t,distance:o},a[t]=!0)}i++}const o={};for(const e of Object.keys(s))o[s[e].value]={value:e,distance:s[e].distance};return o}(Array.from(e.keys()),Array.from(t.keys()),i),c=(n(t)+n(e))/(t.length+e.length);!function(e,t){for(const n of Object.keys(e))e[n].distance>t&&delete e[n]}(o,c+3*Math.sqrt((r(e,c)+r(t,c))/(e.length+t.length)));for(const e of Object.keys(o))o[e]=o[e].value;const u=this.appendMapping(o,e,t);for(const n of u)s.push(e[n]),a.push(t[o[n]]);return[s,a]}let u=r(e.points),l=r(t.points);(u.xmax-u.xmin<1||l.ymax-l.ymin<1)&&(l=u={xmin:0,xmax:1024,ymin:0,ymax:768});const h=i(s(e.points,u)),p=i(s(t.points,l));let d=[],f=[];if(h.length>p.length){const[e,t]=c.call(this,p,h);d=t,f=e}else{const[e,t]=c.call(this,h,p);d=e,f=t}const b=a(o(d),u),m=a(o(f),l),g=[];for(let e=0;e<b.length;e++)g.push(b[e]+(m[e]-b[e])*n);return{points:g,occluded:e.occluded,outside:e.outside,zOrder:e.zOrder}}appendMapping(e,t,n){const r=Object.values(e).map(e=>+e),s=Object.keys(e).map(e=>+e),a=[];function i(e){let t=e,s=e;if(!r.length)throw new l("Interpolation mapping is empty");for(;!r.includes(t);)--t<0&&(t=n.length-1);for(;!r.includes(s);)++s>=n.length&&(s=0);return[t,s]}function o(e,t,r){const s=[];for(;t!==r;)s.push(n[t]),++t>=n.length&&(t=0);s.push(n[r]);let a=0,i=0,o=!1;for(let t=1;t<s.length;t++){const r=s[t],c=s[t-1],u=Math.sqrt(Math.pow(r.x-c.x,2)+Math.pow(r.y-c.y,2));o||(i+=u),a+=u,n[e]===s[t]&&(o=!0)}return a?i/a:0}for(let c=0;c<n.length;c++){const u=r.indexOf(c);if(-1===u){const[r,s]=i(c),u=o(c,r,s),l=n[r],h=n[s],p={x:l.x+(h.x-l.x)*u,y:l.y+(h.y-l.y)*u};t.push(p),e[t.length-1]=c,a.push(t.length-1)}else a.push(s[u])}return a}}class T extends S{constructor(e,t,n,r){super(e,t,n,r),this.shapeType=a.POLYGON;for(const e of Object.values(this.shapes))f(this.shapeType,e.points)}}class C extends S{constructor(e,t,n,r){super(e,t,n,r),this.shapeType=a.POLYLINE;for(const e of Object.values(this.shapes))f(this.shapeType,e.points)}}class A extends S{constructor(e,t,n,r){super(e,t,n,r),this.shapeType=a.POINTS;for(const e of Object.values(this.shapes))f(this.shapeType,e.points)}}j.distance=w.distance,T.distance=O.distance,C.distance=x.distance,A.distance=_.distance,e.exports={RectangleShape:w,PolygonShape:O,PolylineShape:x,PointsShape:_,RectangleTrack:j,PolygonTrack:T,PolylineTrack:C,PointsTrack:A,Track:v,Shape:y,Tag:class extends m{constructor(e,t,n){super(e,t,n)}toJSON(){return{clientID:this.clientID,id:this.serverID,frame:this.frame,label_id:this.label.id,group:this.group,attributes:Object.keys(this.attributes).reduce((e,t)=>(e.push({spec_id:t,value:this.attributes[t]}),e),[])}}get(e){if(e!==this.frame)throw new l("Got frame is not equal to the frame of the shape");return{objectType:i.TAG,clientID:this.clientID,serverID:this.serverID,lock:this.lock,attributes:{...this.attributes},label:this.label,group:this.group,updated:this.updated,frame:e}}save(e,t){if(e!==this.frame)throw new l("Got frame is not equal to the frame of the shape");if(this.lock&&t.lock)return d.call(this,e,this.get(e));if(this.lock&&t.lock)return d.call(this,e,this.get(e));const n=t.updateFlags;if(n.label&&r("label",t.label,null,h),n.attributes){const e=t.label.attributes.reduce((e,t)=>(e[t.id]=t,e),{});for(const n of Object.keys(t.attributes)){const r=t.attributes[n];if(!(n in e))throw new u("Trying to save unknown attribute with id ".concat(n," and value ").concat(r));if(!b(r,e[n]))throw new u("Trying to save an attribute attribute with id ".concat(n," and invalid value ").concat(r))}}if(n.lock&&r("lock",t.lock,"boolean",null),n.label&&(this.label=t.label,this.attributes={},this.appendDefaultAttributes(t.label)),n.attributes)for(const e of Object.keys(t.attributes))this.attributes[e]=t.attributes[e];return n.lock&&(this.lock=t.lock),this.updateTimestamp(n),n.reset(),d.call(this,e,this.get(e))}},objectStateFactory:d}})()},function(e,t,n){(()=>{const t=n(2),{Task:r}=n(6),{ScriptingError:s}="./exceptions";e.exports=class{constructor(e,t,n){this.sessionType=n instanceof r?"task":"job",this.id=n.id,this.version=e,this.collection=t,this.initialObjects={},this.hash=this._getHash();const s=this.collection.export();this._resetState();for(const e of s.shapes)this.initialObjects.shapes[e.id]=e;for(const e of s.tracks)this.initialObjects.tracks[e.id]=e;for(const e of s.tags)this.initialObjects.tags[e.id]=e}_resetState(){this.initialObjects={shapes:{},tracks:{},tags:{}}}_getHash(){const e=this.collection.export();return JSON.stringify(e)}async _request(e,n){return await t.annotations.updateAnnotations(this.sessionType,this.id,e,n)}async _put(e){return await this._request(e,"put")}async _create(e){return await this._request(e,"create")}async _update(e){return await this._request(e,"update")}async _delete(e){return await this._request(e,"delete")}_split(e){const t={created:{shapes:[],tracks:[],tags:[]},updated:{shapes:[],tracks:[],tags:[]},deleted:{shapes:[],tracks:[],tags:[]}},n=["id","label_id","group","frame","occluded","z_order","points","type","shapes","attributes","value","spec_id","outside"];for(const r of Object.keys(e))for(const a of e[r])if(a.id in this.initialObjects[r]){JSON.stringify(a,n)!==JSON.stringify(this.initialObjects[r][a.id],n)&&t.updated[r].push(a)}else{if(void 0!==a.id)throw new s('Id of object is defined "'.concat(a.id,'"')+"but it absents in initial state");t.created[r].push(a)}const r={shapes:e.shapes.map(e=>+e.id),tracks:e.tracks.map(e=>+e.id),tags:e.tags.map(e=>+e.id)};for(const e of Object.keys(this.initialObjects))for(const n of Object.keys(this.initialObjects[e]))if(!r[e].includes(+n)){const r=this.initialObjects[e][n];t.deleted[e].push(r)}return t}_updateCreatedObjects(e,t){const n=e.tracks.length+e.shapes.length+e.tags.length,r=t.tracks.length+t.shapes.length+t.tags.length;if(r!==n)throw new s("Number of indexes is differed by number of saved objects"+"".concat(r," vs ").concat(n));for(const n of Object.keys(t))for(let r=0;r<t[n].length;r++){const s=t[n][r];this.collection.objects[s].serverID=e[n][r].id}}_receiveIndexes(e){const t={tracks:e.tracks.map(e=>e.clientID),shapes:e.shapes.map(e=>e.clientID),tags:e.tags.map(e=>e.clientID)};return e.tracks.concat(e.shapes).concat(e.tags).map(e=>(delete e.clientID,e)),t}async save(e){"function"!=typeof e&&(e=e=>{console.log(e)});const t=this.collection.export(),{flush:n}=this.collection;if(n){e("Created objects are being saved on the server");const n=this._receiveIndexes(t),r=await this._put({...t,version:this.version});this.version=r.version,this.collection.flush=!1,this._updateCreatedObjects(r,n),this._resetState();for(const e of Object.keys(this.initialObjects))for(const t of r[e])this.initialObjects[e][t.id]=t}else{const{created:n,updated:r,deleted:s}=this._split(t);e("Created objects are being saved on the server");const a=this._receiveIndexes(n),i=await this._create({...n,version:this.version});this.version=i.version,this._updateCreatedObjects(i,a);for(const e of Object.keys(this.initialObjects))for(const t of i[e])this.initialObjects[e][t.id]=t;e("Updated objects are being saved on the server"),this._receiveIndexes(r);const o=await this._update({...r,version:this.version});this.version=o.version;for(const e of Object.keys(this.initialObjects))for(const t of o[e])this.initialObjects[e][t.id]=t;e("Deleted objects are being deleted from the server"),this._receiveIndexes(s);const c=await this._delete({...s,version:this.version});this._version=c.version;for(const e of Object.keys(this.initialObjects))for(const t of c[e])delete this.initialObjects[e][t.id]}this.hash=this._getHash()}hasUnsavedChanges(){return this._getHash()!==this.hash}}})()},function(e){e.exports=JSON.parse('{"name":"cvat-core.js","version":"0.1.0","description":"Part of Computer Vision Tool which presents an interface for client-side integration","main":"babel.config.js","scripts":{"build":"webpack","test":"jest --config=jest.config.js --coverage","docs":"jsdoc --readme README.md src/*.js -p -c jsdoc.config.js -d docs","coveralls":"cat ./reports/coverage/lcov.info | coveralls"},"author":"Intel","license":"MIT","devDependencies":{"@babel/cli":"^7.4.4","@babel/core":"^7.4.4","@babel/preset-env":"^7.4.4","airbnb":"0.0.2","babel-eslint":"^10.0.1","babel-loader":"^8.0.6","coveralls":"^3.0.5","eslint":"6.1.0","eslint-config-airbnb-base":"14.0.0","eslint-plugin-import":"2.18.2","eslint-plugin-no-unsafe-innerhtml":"^1.0.16","eslint-plugin-no-unsanitized":"^3.0.2","eslint-plugin-security":"^1.4.0","jest":"^24.8.0","jest-junit":"^6.4.0","jsdoc":"^3.6.2","webpack":"^4.31.0","webpack-cli":"^3.3.2"},"dependencies":{"axios":"^0.18.0","browser-or-node":"^1.2.1","error-stack-parser":"^2.0.2","form-data":"^2.5.0","jest-config":"^24.8.0","js-cookie":"^2.2.0","platform":"^1.3.5","store":"^2.0.12"}}')},function(e,t,n){(()=>{const t=n(5),r=n(2),{isBoolean:s,isInteger:a,isEnum:i,isString:o,checkFilter:c}=n(8),{TaskStatus:u,TaskMode:l}=n(4),h=n(12),{AnnotationFormat:p}=n(21),{ArgumentError:d}=n(0),{Task:f}=n(6);function b(e,t){null!==e.assignee&&([e.assignee]=t.filter(t=>t.id===e.assignee));for(const n of e.segments)for(const e of n.jobs)null!==e.assignee&&([e.assignee]=t.filter(t=>t.id===e.assignee));return null!==e.owner&&([e.owner]=t.filter(t=>t.id===e.owner)),e}e.exports=function(e){return e.plugins.list.implementation=t.list,e.plugins.register.implementation=t.register.bind(e),e.server.about.implementation=async()=>{return await r.server.about()},e.server.share.implementation=async e=>{return await r.server.share(e)},e.server.formats.implementation=async()=>{return(await r.server.formats()).map(e=>new p(e))},e.server.datasetFormats.implementation=async()=>{return await r.server.datasetFormats()},e.server.register.implementation=async(e,t,n,s,a,i)=>{await r.server.register(e,t,n,s,a,i)},e.server.login.implementation=async(e,t)=>{await r.server.login(e,t)},e.server.logout.implementation=async()=>{await r.server.logout()},e.server.authorized.implementation=async()=>{return await r.server.authorized()},e.server.request.implementation=async(e,t)=>{return await r.server.request(e,t)},e.users.get.implementation=async e=>{c(e,{self:s});let t=null;return t=(t="self"in e&&e.self?[t=await r.users.getSelf()]:await r.users.getUsers()).map(e=>new h(e))},e.jobs.get.implementation=async e=>{if(c(e,{taskID:a,jobID:a}),"taskID"in e&&"jobID"in e)throw new d('Only one of fields "taskID" and "jobID" allowed simultaneously');if(!Object.keys(e).length)throw new d("Job filter must not be empty");let t=null;if("taskID"in e)t=await r.tasks.getTasks("id=".concat(e.taskID));else{const n=await r.jobs.getJob(e.jobID);void 0!==n.task_id&&(t=await r.tasks.getTasks("id=".concat(n.task_id)))}if(null!==t&&t.length){const n=(await r.users.getUsers()).map(e=>new h(e)),s=new f(b(t[0],n));return e.jobID?s.jobs.filter(t=>t.id===e.jobID):s.jobs}return[]},e.tasks.get.implementation=async e=>{if(c(e,{page:a,name:o,id:a,owner:o,assignee:o,search:o,status:i.bind(u),mode:i.bind(l)}),"search"in e&&Object.keys(e).length>1&&!("page"in e&&2===Object.keys(e).length))throw new d('Do not use the filter field "search" with others');if("id"in e&&Object.keys(e).length>1&&!("page"in e&&2===Object.keys(e).length))throw new d('Do not use the filter field "id" with others');const t=new URLSearchParams;for(const n of["name","owner","assignee","search","status","mode","id","page"])Object.prototype.hasOwnProperty.call(e,n)&&t.set(n,e[n]);const n=(await r.users.getUsers()).map(e=>new h(e)),s=await r.tasks.getTasks(t.toString()),p=s.map(e=>b(e,n)).map(e=>new f(e));return p.count=s.count,p},e}})()}]);
//# sourceMappingURL=cvat-core.min.js.map